"use strict";function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();!function(){var t=function a(){_classCallCheck(this,a)},e=function(t){function e(t,n,r,s){_classCallCheck(this,e);var o=_possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this));return o.studentId=t,o.studentTasks=[],o.name=n,o.preferredMentorsList=void 0!==r?r:[],o}return _inherits(e,t),_createClass(e,[{key:"addTasks",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],r=this;if(t instanceof n){for(var s in this.studentTasks)if(t==s.task)return;var o={task:t,mark:0};if(this.studentTasks.push(o),e)return;t.addExecutors(this,!0)}else Array.isArray(t)&&t.forEach(function(t,s,o){if(t instanceof n){for(var i in r.studentTasks)if(t==i.task)return;var a={task:t,mark:0};if(r.studentTasks.push(a),e)return;t.addExecutors(r,!0)}});return this}},{key:"removeTasks",value:function(t){var e=this;return t.forEach(function(t,n,r){var s=i.select(t);if(!s)return void console.log("Студент "+t+" не найден.");var o=e.studentTasks.indexOf(s);-1!==o&&e.studentTasks.splice(o,1)}),this}},{key:"setMark",value:function(t,e){var r=i.select(t);if(!(r&&r instanceof n))throw new Error("Задание "+t+" не найдено.");return this.studentTasks.forEach(function(t,n,s){t.task==r&&(t.mark=e)}),this}},{key:"id",set:function(t){throw new Error("Нельзя менять ID.")},get:function(){return this.studentId}},{key:"name",set:function(t){this.studentName=t},get:function(){return this.studentName}},{key:"team",set:function(t){this.studentTeam=t},get:function(){return this.studentTeam}},{key:"preferredMentorsList",set:function(t){if(("undefined"==typeof t?"undefined":_typeof(t))!==_typeof([]))throw new Error("Список должен быть массивом.");t=t.map(function(t,e,n){var r=i.select(t);return r instanceof s||(r=!1),r}),this.studentPreferredMentorsList=t.filter(function(t,e,n){return t!==!1})},get:function(){this.studentPreferredMentorsList}}]),e}(t),n=function(e){function n(t,e,r,s){_classCallCheck(this,n);var o=_possibleConstructorReturn(this,Object.getPrototypeOf(n).call(this));return o.taskId=t,o.title=e,o.content=r,o.taskExecutors=void 0!==s?s:[],o}return _inherits(n,e),_createClass(n,[{key:"addExecutors",value:function(e){var n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],r=this;if(e instanceof t){if(e in this.taskExecutors)return;if(this.taskExecutors.push(e),n)return;e.addTasks(this,!0)}else Array.isArray(e)&&e.forEach(function(t,e,s){t in r.taskExecutors||(r.taskExecutors.push(t),n||t.addTasks(r,!0))});return this}},{key:"removeExecutors",value:function(t){var e=this;return t.forEach(function(t,n,r){var s=i.select(t);if(!s)return void console.log("Студент "+t+" не найден.");var o=e.taskExecutors.indexOf(s);-1!==o&&e.taskExecutors.splice(o,1)}),this}},{key:"id",set:function(t){throw new Error("Нельзя менять ID.")},get:function(){return this.taskId}},{key:"title",set:function(t){this.taskTitle=t},get:function(){return this.taskTitle}},{key:"content",set:function(t){this.taskContent=t},get:function(){return this.taskContent}},{key:"executors",get:function(){return this.taskExecutors}}]),n}(t),r=function(e){function r(t,e,n){_classCallCheck(this,r);var s=_possibleConstructorReturn(this,Object.getPrototypeOf(r).call(this));return s.teamId=t,s.name=e,s.teamTasks=[],s.teammates=void 0!==n?n:[],s}return _inherits(r,e),_createClass(r,[{key:"addTeammates",value:function(e){return e instanceof t?this.teamTeammates.push(e):isArray(e)&&e.forEach(function(t,e,n){this.teamTeammates.push(t)}),this}},{key:"removeTeammates",value:function(t){var e=this;return t.forEach(function(t,n,r){var s=i.select(t);s||console.log("Студент "+t+" не найден.");var o=e.teamTeammates.indexOf(s);-1!==o&&e.teamTeammates.splice(o,1)}),this}},{key:"addTasks",value:function(e){var r=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],s=this;if(e instanceof t){for(var o in s.studentTasks)if(e==o.task)return;var i={task:e,mark:0};if(this.teamTasks.push(i),r)return;e.addExecutors(this,!0)}else Array.isArray(e)&&e.forEach(function(t,e,o){if(t instanceof n){for(var i in s.teamTasks)if(t==i.task)return;var a={task:t,mark:0};if(s.teamTasks.push(a),r)return;t.addExecutors(s,!0)}});return this}},{key:"removeTasks",value:function(t){var e=this;return t.forEach(function(t,n,r){var s=i.select(t);if(!s)return void console.log("Студент "+t+" не найден.");var o=e.teamTasks.indexOf(s);-1!==o&&e.teamTasks.splice(o,1)}),this}},{key:"setMark",value:function(t,e){var r=i.select(t);if(!(r&&r instanceof n))throw new Error("Задание "+t+" не найдено.");return this.teamTasks.forEach(function(t,n,s){t.task==r&&(t.mark=e)}),this}},{key:"id",set:function(t){throw new Error("Нельзя менять ID.")},get:function(){return this.teamId}},{key:"name",set:function(t){this.teamName=t},get:function(){return this.teamName}},{key:"teammates",set:function(t){this.teamTeammates=t},get:function(){return this.teamTeammates}}]),r}(t),s=function(t){function n(t,e,r){_classCallCheck(this,n);var s=_possibleConstructorReturn(this,Object.getPrototypeOf(n).call(this));return s.mentorId=t,s.name=e,s.preferredStudentsList=void 0!==r?r:[],s}return _inherits(n,t),_createClass(n,[{key:"id",set:function(t){throw new Error("Нельзя менять ID.")},get:function(){return this.mentorId}},{key:"name",set:function(t){this.mentorName=t},get:function(){return this.mentorName}},{key:"preferredStudentsList",set:function(t){if(("undefined"==typeof t?"undefined":_typeof(t))!==_typeof([]))throw new Error("Список должен быть массивом.");t=t.map(function(t,n,r){var s=i.select(t);return s instanceof e||(s=!1),s}),this.mentorPreferredStudentsList=t.filter(function(t,e,n){return t!==!1})},get:function(){return this.mentorPreferredStudentsList}}]),n}(t),o=0,i={add:function(t,a){if("undefined"==typeof t||0==t.length)throw new Error("Тип должен быть указан.");if("string"!=typeof t)throw new Error("Тип должен быть строкой");if("undefined"==typeof a||!("name"in a||"title"in a))throw new Error("Отсутствует 'options'. Задайте его хотя бы с одним свойством 'name' или 'title'.");if("object"!=("undefined"==typeof a?"undefined":_typeof(a)))throw new Error("Options должен быть объектом {}.");switch(t){case"student":var u=o++,f=new e(u,a.name,a.preferredMentorsList);if(a.team){var c=this.select(a.team);c||(c=i.add("team",{name:a.team})),f.team=c,c.addTeammates(f,!0)}return i.students.push(f),console.log("Added new Student: "+f.name+"."),f;case"task":var d=o++,h=new n(d,a.title,a.content);if(a.executors){var l=a.executors.map(function(t,n,s){var o=i.select(t);if(!o)throw new Error("Невозможно добавить несуществующего исполнителя "+t+".");if(!(o instanceof e||o instanceof r))throw new Error("Исполнитель должен быть студентом или командой.");return o});h.addExecutors(l)}return i.tasks.push(h),console.log("Added new Task: "+h.title+"."),h;case"team":var m=o++,k=new r(m,a.name);if(a.teammates){var p=a.teammates.map(function(t,n,r){var s=i.select(t);if(!s)throw new Error("Невозможно добавить в команду несуществующего студента "+t+".");if(!(s instanceof e))throw new Error("В команде могут состоять только студенты.");return s});k.addTeammates(p)}return i.teams.push(k),console.log("Added new Team: "+k.name+"."),k;case"mentor":var y=o++,v=new s(y,a.name,a.preferredStudentsList);return i.mentors.push(v),console.log("Added new Mentor: "+v.name+"."),v;default:throw new Error("Типа '"+t+"' не существует.")}},edit:function(t,e){if("undefined"==typeof t||0==t.length)throw new Error("Селектор должен быть указан.");if("string"!=typeof t&&"number"!=typeof t)throw new Error("Селектор должен быть строкой или числом");if("undefined"==typeof e)throw new Error("Отсутствует 'options'. Задайте его хотя бы с одним свойством.");if("object"!=("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("Options должен быть объектом {}.");var n=this.select(t);for(var r in e)"id"!=r&&(n[r]=e[r]);return n},students:[],mentors:[],tasks:[],teams:[],select:function(e){var n=void 0;if("number"!=typeof e&&isNaN(e)){if("string"==typeof e){if(i.students.forEach(function(t,r,s){t.name!=e||n||(n=t)}),n)return n;if(i.mentors.forEach(function(t,r,s){t.name!=e||n||(n=t)}),n)return n;if(i.tasks.forEach(function(t,r,s){t.title!=e||n||(n=t)}),n)return n;if(i.teams.forEach(function(t,r,s){t.name!=e||n||(n=t)}),n)return n}else if(e instanceof t)return e}else{var e=parseInt(e);if(i.students.forEach(function(t,r,s){t.id!=e||n||(n=t)}),n)return n;if(i.mentors.forEach(function(t,r,s){t.id!=e||n||(n=t)}),n)return n;if(i.tasks.forEach(function(t,r,s){t.id!=e||n||(n=t)}),n)return n;if(i.teams.forEach(function(t,r,s){t.id!=e||n||(n=t)}),n)return n}return void 0==n?!1:n}};new e("Никита");window.Lib=i}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIiwiU3R1ZGVudC5qcyIsIlRhc2suanMiLCJUZWFtLmpzIiwiTWVudG9yLmpzIl0sIm5hbWVzIjpbIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwic2VsZiIsImNhbGwiLCJSZWZlcmVuY2VFcnJvciIsIl9pbmhlcml0cyIsInN1YkNsYXNzIiwic3VwZXJDbGFzcyIsIlR5cGVFcnJvciIsInByb3RvdHlwZSIsIk9iamVjdCIsImNyZWF0ZSIsImNvbnN0cnVjdG9yIiwidmFsdWUiLCJlbnVtZXJhYmxlIiwid3JpdGFibGUiLCJjb25maWd1cmFibGUiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJfdHlwZW9mIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJvYmoiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiTGliT2JqZWN0IiwidGhpcyIsIlN0dWRlbnQiLCJfTGliT2JqZWN0IiwibmV3SWQiLCJuZXdOYW1lIiwibmV3TWVudG9ycyIsIm5ld1RlYW0iLCJfdGhpcyIsImdldFByb3RvdHlwZU9mIiwic3R1ZGVudElkIiwic3R1ZGVudFRhc2tzIiwibmFtZSIsInByZWZlcnJlZE1lbnRvcnNMaXN0IiwidW5kZWZpbmVkIiwidGFza3MiLCJzdG9wIiwiYXJndW1lbnRzIiwiVGFzayIsIml0ZW0iLCJ0YXNrIiwidGFza1JlY29yZCIsIm1hcmsiLCJwdXNoIiwiYWRkRXhlY3V0b3JzIiwiQXJyYXkiLCJpc0FycmF5IiwiZm9yRWFjaCIsImFyciIsImlubmVySXRlbSIsIl90YXNrUmVjb3JkIiwiTGliIiwic2VsZWN0IiwiY29uc29sZSIsImxvZyIsImluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsInNlbGVjdG9yIiwiRXJyb3IiLCJzZXQiLCJnZXQiLCJzdHIiLCJzdHVkZW50TmFtZSIsInN0dWRlbnRUZWFtIiwibWFwIiwibWVudG9yIiwiTWVudG9yIiwic3R1ZGVudFByZWZlcnJlZE1lbnRvcnNMaXN0IiwiZmlsdGVyIiwiX0xpYk9iamVjdDIiLCJuZXdUaXRsZSIsIm5ld0NvbnRlbnQiLCJuZXdFeGVjdXRvcnMiLCJfdGhpczIiLCJ0YXNrSWQiLCJ0aXRsZSIsImNvbnRlbnQiLCJ0YXNrRXhlY3V0b3JzIiwiZXhlY3V0b3JzIiwiYWRkVGFza3MiLCJleGVjdXRvciIsInRhc2tUaXRsZSIsInRhc2tDb250ZW50IiwiVGVhbSIsIl9MaWJPYmplY3QzIiwibmV3VGVhbW1hdGVzIiwiX3RoaXMzIiwidGVhbUlkIiwidGVhbVRhc2tzIiwidGVhbW1hdGVzIiwic3R1ZGVudHMiLCJ0ZWFtVGVhbW1hdGVzIiwic3R1ZGVudCIsIl90YXNrUmVjb3JkMiIsInRlYW1OYW1lIiwiX0xpYk9iamVjdDQiLCJuZXdQcmVmZXJyZWRTdHVkZW50c0xpc3QiLCJfdGhpczQiLCJtZW50b3JJZCIsInByZWZlcnJlZFN0dWRlbnRzTGlzdCIsIm1lbnRvck5hbWUiLCJtZW50b3JQcmVmZXJyZWRTdHVkZW50c0xpc3QiLCJ1bmlxdWVJZCIsImFkZCIsInR5cGUiLCJvcHRpb25zIiwic3R1ZElkIiwibmV3U3R1ZGVudCIsInRlYW0iLCJ0ZWFtT2JqIiwiYWRkVGVhbW1hdGVzIiwibmV3VGFzayIsInJlcyIsIm5ld01hdGUiLCJ0ZWFtcyIsIm5ld01lbnRvciIsIm1lbnRvcnMiLCJlZGl0Iiwib2JqZWN0IiwicHJvcCIsInJlc3VsdCIsImlzTmFOIiwicGFyc2VJbnQiLCJpZCIsIndpbmRvdyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFNQSxTQUFTQSw0QkFBMkJDLEVBQU1DLEdBQVEsSUFBS0QsRUFBUSxLQUFNLElBQUlFLGdCQUFlLDREQUFnRSxRQUFPRCxHQUF5QixnQkFBVEEsSUFBcUMsa0JBQVRBLEdBQThC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QUFBQSxFQVFBLElBTEF0RSxFQUFBZ0UsTUFBQXBFLFFBQUEsU0FBQVIsRUFBQTFCLEVBQUFtQyxHQUNBVCxFQUFBUCxNQUFBMEIsR0FBQStELElBQ0FBLEVBQUFsRixLQUdBa0YsRUFBQSxNQUFBQSxPQUVBLElBQUEvRCxZQUFBdEMsR0FDQSxNQUFBc0MsT0FyRUEsQ0FDQSxHQUFBQSxHQUFBaUUsU0FBQWpFLEVBT0EsSUFMQVAsRUFBQXdDLFNBQUE1QyxRQUFBLFNBQUFSLEVBQUExQixFQUFBbUMsR0FDQVQsRUFBQXFGLElBQUFsRSxHQUFBK0QsSUFDQUEsRUFBQWxGLEtBR0FrRixFQUFBLE1BQUFBLEVBUUEsSUFMQXRFLEVBQUFrRSxRQUFBdEUsUUFBQSxTQUFBUixFQUFBMUIsRUFBQW1DLEdBQ0FULEVBQUFxRixJQUFBbEUsR0FBQStELElBQ0FBLEVBQUFsRixLQUdBa0YsRUFBQSxNQUFBQSxFQVFBLElBTEF0RSxFQUFBaEIsTUFBQVksUUFBQSxTQUFBUixFQUFBMUIsRUFBQW1DLEdBQ0FULEVBQUFxRixJQUFBbEUsR0FBQStELElBQ0FBLEVBQUFsRixLQUdBa0YsRUFBQSxNQUFBQSxFQVFBLElBTEF0RSxFQUFBZ0UsTUFBQXBFLFFBQUEsU0FBQVIsRUFBQTFCLEVBQUFtQyxHQUNBVCxFQUFBcUYsSUFBQWxFLEdBQUErRCxJQUNBQSxFQUFBbEYsS0FHQWtGLEVBQUEsTUFBQUEsR0F3Q0EsTUFBQXZGLFNBQUF1RixHQUNBLEVBR0FBLEdBS0EsSUFBQW5HLEdBQUEsU0FDQXVHLFFBQUExRSxJQUFBQSIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbihmdW5jdGlvbigpe1xuXG5jbGFzcyBMaWJPYmplY3Qge1xuXG59XG5cbmNsYXNzIFN0dWRlbnQgZXh0ZW5kcyBMaWJPYmplY3Qge1xuXHRjb25zdHJ1Y3RvcihuZXdJZCwgbmV3TmFtZSwgbmV3TWVudG9ycywgbmV3VGVhbSkge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy5zdHVkZW50SWQgPSBuZXdJZDtcblx0XHR0aGlzLnN0dWRlbnRUYXNrcyA9IFtdO1xuXHRcdHRoaXMubmFtZSA9IG5ld05hbWU7XG5cdFx0Ly8gaWYgKG5ld1RlYW0gIT09IHVuZGVmaW5lZCkgdGhpcy50ZWFtID0gbmV3VGVhbTtcblx0XHR0aGlzLnByZWZlcnJlZE1lbnRvcnNMaXN0ID0gKG5ld01lbnRvcnMgIT09IHVuZGVmaW5lZClcblx0XHRcdD8gbmV3TWVudG9yc1xuXHRcdFx0OiBbXTtcblx0fVxuXG5cblx0c2V0IGlkKG5ld0lkKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCfQndC10LvRjNC30Y8g0LzQtdC90Y/RgtGMIElELicpO1xuXHRcdHJldHVybjtcblx0fVxuXHRnZXQgaWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMuc3R1ZGVudElkO1xuXHR9XG5cblx0c2V0IG5hbWUoc3RyKSB7XG5cdFx0dGhpcy5zdHVkZW50TmFtZSA9IHN0cjtcblx0fVxuXHRnZXQgbmFtZSgpe1xuXHRcdHJldHVybiB0aGlzLnN0dWRlbnROYW1lO1xuXHR9XG5cblx0c2V0IHRlYW0ob2JqKSB7XG5cdFx0dGhpcy5zdHVkZW50VGVhbSA9IG9iajtcblx0fVxuXHRnZXQgdGVhbSgpIHtcblx0XHRyZXR1cm4gdGhpcy5zdHVkZW50VGVhbTtcblx0fVxuXG5cdHNldCBwcmVmZXJyZWRNZW50b3JzTGlzdChhcnIpIHtcblx0XHRpZiAodHlwZW9mIGFyciAhPT0gdHlwZW9mIFtdICkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQodC/0LjRgdC+0Log0LTQvtC70LbQtdC9INCx0YvRgtGMINC80LDRgdGB0LjQstC+0LwuJyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0YXJyID0gYXJyLm1hcChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0bGV0IG1lbnRvciA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIShtZW50b3IgaW5zdGFuY2VvZiBNZW50b3IpKSBtZW50b3IgPSBmYWxzZTtcblx0XHRcdHJldHVybiBtZW50b3I7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnN0dWRlbnRQcmVmZXJyZWRNZW50b3JzTGlzdCA9IGFyci5maWx0ZXIoZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGlmIChpdGVtID09PSBmYWxzZSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRnZXQgcHJlZmVycmVkTWVudG9yc0xpc3QoKSB7XG5cdFx0dGhpcy5zdHVkZW50UHJlZmVycmVkTWVudG9yc0xpc3Q7XG5cdH1cblxuXHRhZGRUYXNrcyh0YXNrcywgc3RvcCA9IGZhbHNlKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdGlmICh0YXNrcyBpbnN0YW5jZW9mIFRhc2spIHtcblx0XHRcdGZvciAobGV0IGl0ZW0gaW4gdGhpcy5zdHVkZW50VGFza3MpIHtcblx0XHRcdFx0aWYgKHRhc2tzID09IGl0ZW0udGFzaykgcmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0bGV0IHRhc2tSZWNvcmQgPSB7XG5cdFx0XHRcdHRhc2s6IHRhc2tzLFxuXHRcdFx0XHRtYXJrOiAwXG5cdFx0XHR9XG5cdFx0XHR0aGlzLnN0dWRlbnRUYXNrcy5wdXNoKHRhc2tSZWNvcmQpO1x0XG5cdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0dGFza3MuYWRkRXhlY3V0b3JzKHRoaXMsIHRydWUpO1xuXHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh0YXNrcykpIHtcblx0XHRcdHRhc2tzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdFx0aWYgKGl0ZW0gaW5zdGFuY2VvZiBUYXNrKSB7XG5cdFx0XHRcdFx0Zm9yIChsZXQgaW5uZXJJdGVtIGluIHNlbGYuc3R1ZGVudFRhc2tzKSB7XG5cdFx0XHRcdFx0XHRpZiAoaXRlbSA9PSBpbm5lckl0ZW0udGFzaykgcmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRsZXQgdGFza1JlY29yZCA9IHtcblx0XHRcdFx0XHRcdHRhc2s6IGl0ZW0sXG5cdFx0XHRcdFx0XHRtYXJrOiAwXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHNlbGYuc3R1ZGVudFRhc2tzLnB1c2godGFza1JlY29yZCk7XG5cdFx0XHRcdFx0aWYgKHN0b3ApIHJldHVybjtcblx0XHRcdFx0XHRpdGVtLmFkZEV4ZWN1dG9ycyhzZWxmLCB0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0cmVtb3ZlVGFza3MoYXJyKSB7XG5cdFx0bGV0IHNlbGYgPSB0aGlzO1xuXHRcdGFyci5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgdGFzayA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIXRhc2spIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ9Ch0YLRg9C00LXQvdGCICcrIGl0ZW0gKycg0L3QtSDQvdCw0LnQtNC10L0uJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGxldCBpbmRleCA9IHNlbGYuc3R1ZGVudFRhc2tzLmluZGV4T2YodGFzayk7XG5cdFx0XHRpZiAoaW5kZXggIT09IC0xKSB7XG5cdFx0XHRcdHNlbGYuc3R1ZGVudFRhc2tzLnNwbGljZShpbmRleCwxKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdHNldE1hcmsoc2VsZWN0b3IsIG1hcmspIHtcblx0XHRsZXQgdGFzayA9IExpYi5zZWxlY3Qoc2VsZWN0b3IpO1xuXHRcdGlmICghdGFzayB8fCAhKHRhc2sgaW5zdGFuY2VvZiBUYXNrKSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQl9Cw0LTQsNC90LjQtSAnK3NlbGVjdG9yKycg0L3QtSDQvdCw0LnQtNC10L3Qvi4nKTtcblx0XHR9XG5cdFx0dGhpcy5zdHVkZW50VGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0aWYgKGl0ZW0udGFzayA9PSB0YXNrKSB7XG5cdFx0XHRcdGl0ZW0ubWFyayA9IG1hcms7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG59XG5jbGFzcyBUYXNrIGV4dGVuZHMgTGliT2JqZWN0IHtcblx0Y29uc3RydWN0b3IobmV3SWQsIG5ld1RpdGxlLCBuZXdDb250ZW50LCBuZXdFeGVjdXRvcnMpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMudGFza0lkID0gbmV3SWQ7XG5cdFx0dGhpcy50aXRsZSA9IG5ld1RpdGxlO1xuXHRcdHRoaXMuY29udGVudCA9IG5ld0NvbnRlbnQ7XG5cdFx0dGhpcy50YXNrRXhlY3V0b3JzID0gKG5ld0V4ZWN1dG9ycyAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0PyBuZXdFeGVjdXRvcnNcblx0XHRcdDogW107XG5cdH1cblxuXHRzZXQgaWQobmV3SWQpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Cd0LXQu9GM0LfRjyDQvNC10L3Rj9GC0YwgSUQuJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGdldCBpZCgpIHtcblx0XHRyZXR1cm4gdGhpcy50YXNrSWQ7XG5cdH1cblxuXHRzZXQgdGl0bGUoc3RyKSB7XG5cdFx0dGhpcy50YXNrVGl0bGUgPSBzdHI7XG5cdH1cblx0Z2V0IHRpdGxlKCl7XG5cdFx0cmV0dXJuIHRoaXMudGFza1RpdGxlO1xuXHR9XG5cblx0c2V0IGNvbnRlbnQoc3RyKSB7XG5cdFx0dGhpcy50YXNrQ29udGVudCA9IHN0cjtcblx0fVxuXHRnZXQgY29udGVudCgpIHtcblx0XHRyZXR1cm4gdGhpcy50YXNrQ29udGVudDtcblx0fVxuXG5cdC8vIHNldCBleGVjdXRvcnMoYXJyKSB7XG5cdC8vIFx0dGhpcy50YXNrRXhlY3V0b3JzID0gYXJyO1xuXHQvLyB9XG5cdGdldCBleGVjdXRvcnMoKSB7XG5cdFx0cmV0dXJuIHRoaXMudGFza0V4ZWN1dG9yc1xuXHR9XG5cblx0YWRkRXhlY3V0b3JzKGV4ZWN1dG9ycywgc3RvcCA9IGZhbHNlKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdGlmIChleGVjdXRvcnMgaW5zdGFuY2VvZiBMaWJPYmplY3QpIHtcblx0XHRcdGlmIChleGVjdXRvcnMgaW4gdGhpcy50YXNrRXhlY3V0b3JzKSByZXR1cm47XG5cdFx0XHR0aGlzLnRhc2tFeGVjdXRvcnMucHVzaChleGVjdXRvcnMpO1xuXHRcdFx0aWYgKHN0b3ApIHJldHVybjtcblx0XHRcdGV4ZWN1dG9ycy5hZGRUYXNrcyh0aGlzLCB0cnVlKTtcblx0XHR9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoZXhlY3V0b3JzKSkge1xuXHRcdFx0ZXhlY3V0b3JzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdFx0aWYgKGl0ZW0gaW4gc2VsZi50YXNrRXhlY3V0b3JzKSByZXR1cm47XG5cdFx0XHRcdHNlbGYudGFza0V4ZWN1dG9ycy5wdXNoKGl0ZW0pO1xuXHRcdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0XHRpdGVtLmFkZFRhc2tzKHNlbGYsIHRydWUpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0cmVtb3ZlRXhlY3V0b3JzKGFycikge1xuXHRcdGxldCBzZWxmID0gdGhpcztcblx0XHRhcnIuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0bGV0IGV4ZWN1dG9yID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdGlmICghZXhlY3V0b3IpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ9Ch0YLRg9C00LXQvdGCICcrIGl0ZW0gKycg0L3QtSDQvdCw0LnQtNC10L0uJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGxldCBpbmRleCA9IHNlbGYudGFza0V4ZWN1dG9ycy5pbmRleE9mKGV4ZWN1dG9yKTtcblx0XHRcdGlmIChpbmRleCAhPT0gLTEpIHtcblx0XHRcdFx0c2VsZi50YXNrRXhlY3V0b3JzLnNwbGljZShpbmRleCwxKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG59XG5jbGFzcyBUZWFtIGV4dGVuZHMgTGliT2JqZWN0IHtcblx0Y29uc3RydWN0b3IobmV3SWQsIG5ld05hbWUsIG5ld1RlYW1tYXRlcykge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy50ZWFtSWQgPSBuZXdJZDtcblx0XHR0aGlzLm5hbWUgPSBuZXdOYW1lO1xuXHRcdHRoaXMudGVhbVRhc2tzID0gW107XG5cdFx0dGhpcy50ZWFtbWF0ZXMgPSAobmV3VGVhbW1hdGVzICE9PSB1bmRlZmluZWQpIFxuXHRcdFx0PyBuZXdUZWFtbWF0ZXNcblx0XHRcdDogW107XG5cdH1cblxuXHRzZXQgaWQobmV3SWQpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Cd0LXQu9GM0LfRjyDQvNC10L3Rj9GC0YwgSUQuJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGdldCBpZCgpIHtcblx0XHRyZXR1cm4gdGhpcy50ZWFtSWQ7XG5cdH1cblxuXHRzZXQgbmFtZShzdHIpIHtcblx0XHR0aGlzLnRlYW1OYW1lID0gc3RyO1xuXHR9XG5cdGdldCBuYW1lKCl7XG5cdFx0cmV0dXJuIHRoaXMudGVhbU5hbWU7XG5cdH1cblxuXHRzZXQgdGVhbW1hdGVzKGFycikge1xuXHRcdHRoaXMudGVhbVRlYW1tYXRlcyA9IGFycjtcblx0fVxuXHRnZXQgdGVhbW1hdGVzKCkge1xuXHRcdHJldHVybiB0aGlzLnRlYW1UZWFtbWF0ZXM7XG5cdH1cblxuXHRhZGRUZWFtbWF0ZXMoc3R1ZGVudHMpIHtcblx0XHRpZiAoc3R1ZGVudHMgaW5zdGFuY2VvZiBMaWJPYmplY3QpIHtcblx0XHRcdHRoaXMudGVhbVRlYW1tYXRlcy5wdXNoKHN0dWRlbnRzKTtcdFxuXHRcdH0gZWxzZSBpZiAoaXNBcnJheShzdHVkZW50cykpIHtcblx0XHRcdHN0dWRlbnRzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdFx0dGhpcy50ZWFtVGVhbW1hdGVzLnB1c2goaXRlbSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRyZW1vdmVUZWFtbWF0ZXMoYXJyKSB7XG5cdFx0bGV0IHNlbGYgPSB0aGlzO1xuXHRcdGFyci5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgc3R1ZGVudCA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIXN0dWRlbnQpIGNvbnNvbGUubG9nKCfQodGC0YPQtNC10L3RgiAnKyBpdGVtICsnINC90LUg0L3QsNC50LTQtdC9LicpO1xuXHRcdFx0bGV0IGluZGV4ID0gc2VsZi50ZWFtVGVhbW1hdGVzLmluZGV4T2Yoc3R1ZGVudCk7XG5cdFx0XHRpZiAoaW5kZXggIT09IC0xKSB7XG5cdFx0XHRcdHNlbGYudGVhbVRlYW1tYXRlcy5zcGxpY2UoaW5kZXgsMSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRhZGRUYXNrcyh0YXNrcywgc3RvcCA9IGZhbHNlKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdGlmICh0YXNrcyBpbnN0YW5jZW9mIExpYk9iamVjdCkge1xuXHRcdFx0Zm9yIChsZXQgaXRlbSBpbiBzZWxmLnN0dWRlbnRUYXNrcykge1xuXHRcdFx0XHRpZiAodGFza3MgPT0gaXRlbS50YXNrKSByZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRsZXQgdGFza1JlY29yZCA9IHtcblx0XHRcdFx0dGFzazogdGFza3MsXG5cdFx0XHRcdG1hcms6IDBcblx0XHRcdH1cblx0XHRcdHRoaXMudGVhbVRhc2tzLnB1c2godGFza1JlY29yZCk7XG5cdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0dGFza3MuYWRkRXhlY3V0b3JzKHRoaXMsIHRydWUpO1xuXHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh0YXNrcykpIHtcblx0XHRcdHRhc2tzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdFx0aWYgKGl0ZW0gaW5zdGFuY2VvZiBUYXNrKSB7XG5cdFx0XHRcdFx0Zm9yIChsZXQgaW5uZXJJdGVtIGluIHNlbGYudGVhbVRhc2tzKSB7XG5cdFx0XHRcdFx0XHRpZiAoaXRlbSA9PSBpbm5lckl0ZW0udGFzaykgcmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRsZXQgdGFza1JlY29yZCA9IHtcblx0XHRcdFx0XHRcdHRhc2s6IGl0ZW0sXG5cdFx0XHRcdFx0XHRtYXJrOiAwXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHNlbGYudGVhbVRhc2tzLnB1c2godGFza1JlY29yZCk7XG5cdFx0XHRcdFx0aWYgKHN0b3ApIHJldHVybjtcblx0XHRcdFx0XHRpdGVtLmFkZEV4ZWN1dG9ycyhzZWxmLCB0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0cmVtb3ZlVGFza3MoYXJyKSB7XG5cdFx0bGV0IHNlbGYgPSB0aGlzO1xuXHRcdGFyci5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgdGFzayA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIXRhc2spIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ9Ch0YLRg9C00LXQvdGCICcrIGl0ZW0gKycg0L3QtSDQvdCw0LnQtNC10L0uJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGxldCBpbmRleCA9IHNlbGYudGVhbVRhc2tzLmluZGV4T2YodGFzayk7XG5cdFx0XHRpZiAoaW5kZXggIT09IC0xKSB7XG5cdFx0XHRcdHNlbGYudGVhbVRhc2tzLnNwbGljZShpbmRleCwxKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdHNldE1hcmsoc2VsZWN0b3IsIG1hcmspIHtcblx0XHRsZXQgdGFzayA9IExpYi5zZWxlY3Qoc2VsZWN0b3IpO1xuXHRcdGlmICghdGFzayB8fCAhKHRhc2sgaW5zdGFuY2VvZiBUYXNrKSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQl9Cw0LTQsNC90LjQtSAnK3NlbGVjdG9yKycg0L3QtSDQvdCw0LnQtNC10L3Qvi4nKTtcblx0XHR9XG5cdFx0dGhpcy50ZWFtVGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpIHtcblx0XHRcdGlmIChpdGVtLnRhc2sgPT0gdGFzaykge1xuXHRcdFx0XHRpdGVtLm1hcmsgPSBtYXJrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cbn1cbmNsYXNzIE1lbnRvciBleHRlbmRzIExpYk9iamVjdCB7XG5cdGNvbnN0cnVjdG9yKG5ld0lkLCBuZXdOYW1lLCBuZXdQcmVmZXJyZWRTdHVkZW50c0xpc3QpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMubWVudG9ySWQgPSBuZXdJZDtcblx0XHR0aGlzLm5hbWUgPSBuZXdOYW1lO1xuXHRcdHRoaXMucHJlZmVycmVkU3R1ZGVudHNMaXN0ID0gKG5ld1ByZWZlcnJlZFN0dWRlbnRzTGlzdCAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0PyBuZXdQcmVmZXJyZWRTdHVkZW50c0xpc3Rcblx0XHRcdDogW107XG5cdH1cblxuXHRzZXQgaWQobmV3SWQpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Cd0LXQu9GM0LfRjyDQvNC10L3Rj9GC0YwgSUQuJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGdldCBpZCgpIHtcblx0XHRyZXR1cm4gdGhpcy5tZW50b3JJZDtcblx0fVxuXG5cdHNldCBuYW1lKHN0cikge1xuXHRcdHRoaXMubWVudG9yTmFtZSA9IHN0cjtcblx0fVxuXHRnZXQgbmFtZSgpe1xuXHRcdHJldHVybiB0aGlzLm1lbnRvck5hbWU7XG5cdH1cblxuXHRzZXQgcHJlZmVycmVkU3R1ZGVudHNMaXN0KGFycikge1xuXHRcdGlmICh0eXBlb2YgYXJyICE9PSB0eXBlb2YgW10gKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Ch0L/QuNGB0L7QuiDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0LzQsNGB0YHQuNCy0L7QvC4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRhcnIgPSBhcnIubWFwKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgc3R1ZGVudCA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIShzdHVkZW50IGluc3RhbmNlb2YgU3R1ZGVudCkpIHN0dWRlbnQgPSBmYWxzZTtcblx0XHRcdHJldHVybiBzdHVkZW50O1xuXHRcdH0pO1xuXG5cdFx0Ly8gdGhpcy5tZW50b3JQcmVmZXJyZWRTdHVkZW50c0xpc3QgPSBhcnI7XG5cblx0XHR0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdCA9IGFyci5maWx0ZXIoZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGlmIChpdGVtID09PSBmYWxzZSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRnZXQgcHJlZmVycmVkU3R1ZGVudHNMaXN0KCkge1xuXHRcdHJldHVybiB0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdDtcblx0fVxuXHRcbn1cblxudmFyIHVuaXF1ZUlkID0gMDtcblxudmFyIExpYiA9IHtcblxuXHRhZGQ6IGZ1bmN0aW9uKHR5cGUsIG9wdGlvbnMsIC4uLmFyZ3Mpe1xuXG5cdFx0Ly8g0J7QsdGA0LDQsdC+0YLQutCwINC+0YjQuNCx0L7QulxuXHRcdGlmICgodHlwZW9mIHR5cGUgPT09ICd1bmRlZmluZWQnKSB8fCAodHlwZS5sZW5ndGggPT0gMCkpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Ci0LjQvyDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0YPQutCw0LfQsNC9LicpXG5cdFx0ZWxzZSBpZiAodHlwZW9mIHR5cGUgIT0gJ3N0cmluZycpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Ci0LjQvyDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0YHRgtGA0L7QutC+0LknKTtcblx0XHRcblx0XHRpZiAoKHR5cGVvZiBvcHRpb25zID09PSAndW5kZWZpbmVkJykgfHwgKCEoJ25hbWUnIGluIG9wdGlvbnMpICYmICEoJ3RpdGxlJyBpbiBvcHRpb25zKSkpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Ce0YLRgdGD0YLRgdGC0LLRg9C10YIgXFwnb3B0aW9uc1xcJy4g0JfQsNC00LDQudGC0LUg0LXQs9C+INGF0L7RgtGPINCx0Ysg0YEg0L7QtNC90LjQvCDRgdCy0L7QudGB0YLQstC+0LwgXFwnbmFtZVxcJyDQuNC70LggXFwndGl0bGVcXCcuJylcblx0XHRlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucyAhPSAnb2JqZWN0Jylcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3B0aW9ucyDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0L7QsdGK0LXQutGC0L7QvCB7fS4nKTtcblxuXHRcdC8vINCU0L7QsdCw0LLQu9C10L3QuNC1INC+0LHRitC10LrRgtCwXG5cdFx0c3dpdGNoICh0eXBlKSB7XG5cdFx0XHRcblx0XHRcdGNhc2UgJ3N0dWRlbnQnOlxuXHRcdFx0XHRsZXQgc3R1ZElkID0gdW5pcXVlSWQrKztcblx0XHRcdFx0bGV0IG5ld1N0dWRlbnQgPSBuZXcgU3R1ZGVudChzdHVkSWQsIG9wdGlvbnMubmFtZSwgb3B0aW9ucy5wcmVmZXJyZWRNZW50b3JzTGlzdCk7XG5cblx0XHRcdFx0aWYgKG9wdGlvbnMudGVhbSkge1xuXHRcdFx0XHRcdGxldCB0ZWFtT2JqID0gdGhpcy5zZWxlY3Qob3B0aW9ucy50ZWFtKTtcblx0XHRcdFx0XHRpZiAoIXRlYW1PYmopIHtcblx0XHRcdFx0XHRcdHRlYW1PYmogPSBMaWIuYWRkKCd0ZWFtJywge25hbWU6IG9wdGlvbnMudGVhbX0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRuZXdTdHVkZW50LnRlYW0gPSB0ZWFtT2JqO1xuXHRcdFx0XHRcdHRlYW1PYmouYWRkVGVhbW1hdGVzKG5ld1N0dWRlbnQsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRMaWIuc3R1ZGVudHMucHVzaChuZXdTdHVkZW50KTtcblx0XHRcdFx0Y29uc29sZS5sb2coJ0FkZGVkIG5ldyBTdHVkZW50OiAnKyBuZXdTdHVkZW50Lm5hbWUgKycuJyk7XG5cdFx0XHRcdHJldHVybiBuZXdTdHVkZW50O1xuXHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgJ3Rhc2snOlxuXHRcdFx0XHRsZXQgdGFza0lkID0gdW5pcXVlSWQrKztcblx0XHRcdFx0bGV0IG5ld1Rhc2sgPSBuZXcgVGFzayh0YXNrSWQsIG9wdGlvbnMudGl0bGUsIG9wdGlvbnMuY29udGVudCk7XG5cblx0XHRcdFx0aWYgKG9wdGlvbnMuZXhlY3V0b3JzKSB7XG5cdFx0XHRcdFx0dmFyIG5ld0V4ZWN1dG9ycyA9IG9wdGlvbnMuZXhlY3V0b3JzLm1hcChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0XHRcdFx0bGV0IHJlcyA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRcdFx0XHRpZiAoIXJlcylcblx0XHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQndC10LLQvtC30LzQvtC20L3QviDQtNC+0LHQsNCy0LjRgtGMINC90LXRgdGD0YnQtdGB0YLQstGD0Y7RidC10LPQviDQuNGB0L/QvtC70L3QuNGC0LXQu9GPICcraXRlbSsnLicpO1xuXHRcdFx0XHRcdFx0aWYgKCEocmVzIGluc3RhbmNlb2YgU3R1ZGVudCkgJiYgIShyZXMgaW5zdGFuY2VvZiBUZWFtKSlcblx0XHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQmNGB0L/QvtC70L3QuNGC0LXQu9GMINC00L7Qu9C20LXQvSDQsdGL0YLRjCDRgdGC0YPQtNC10L3RgtC+0Lwg0LjQu9C4INC60L7QvNCw0L3QtNC+0LkuJyk7XG5cdFx0XHRcdFx0XHQvLyByZXMuYWRkVGFza3MobmV3VGFzayk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcmVzO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdG5ld1Rhc2suYWRkRXhlY3V0b3JzKG5ld0V4ZWN1dG9ycyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdExpYi50YXNrcy5wdXNoKG5ld1Rhc2spO1xuXHRcdFx0XHRjb25zb2xlLmxvZygnQWRkZWQgbmV3IFRhc2s6ICcrIG5ld1Rhc2sudGl0bGUgKycuJyk7XG5cdFx0XHRcdHJldHVybiBuZXdUYXNrO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgJ3RlYW0nOlxuXHRcdFx0XHRsZXQgdGVhbUlkID0gdW5pcXVlSWQrKztcblx0XHRcdFx0bGV0IG5ld1RlYW0gPSBuZXcgVGVhbSh0ZWFtSWQsIG9wdGlvbnMubmFtZSk7XG5cblx0XHRcdFx0aWYgKG9wdGlvbnMudGVhbW1hdGVzKSB7XG5cdFx0XHRcdFx0dmFyIG5ld1RlYW1tYXRlcyA9IG9wdGlvbnMudGVhbW1hdGVzLm1hcChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXG5cdFx0XHRcdFx0XHRsZXQgbmV3TWF0ZSA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRcdFx0XHRpZiAoIW5ld01hdGUpXG5cdFx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcign0J3QtdCy0L7Qt9C80L7QttC90L4g0LTQvtCx0LDQstC40YLRjCDQsiDQutC+0LzQsNC90LTRgyDQvdC10YHRg9GJ0LXRgdGC0LLRg9GO0YnQtdCz0L4g0YHRgtGD0LTQtdC90YLQsCAnK2l0ZW0rJy4nKTtcblx0XHRcdFx0XHRcdGlmICghKG5ld01hdGUgaW5zdGFuY2VvZiBTdHVkZW50KSlcblx0XHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQkiDQutC+0LzQsNC90LTQtSDQvNC+0LPRg9GCINGB0L7RgdGC0L7Rj9GC0Ywg0YLQvtC70YzQutC+INGB0YLRg9C00LXQvdGC0YsuJyk7XG5cdFx0XHRcdFx0XHQvLyBuZXdNYXRlLnRlYW0gPSBuZXdUZWFtO1xuXHRcdFx0XHRcdFx0cmV0dXJuIG5ld01hdGU7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRuZXdUZWFtLmFkZFRlYW1tYXRlcyhuZXdUZWFtbWF0ZXMpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0TGliLnRlYW1zLnB1c2gobmV3VGVhbSk7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdBZGRlZCBuZXcgVGVhbTogJysgbmV3VGVhbS5uYW1lICsnLicpO1xuXHRcdFx0XHRyZXR1cm4gbmV3VGVhbTtcblx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlICdtZW50b3InOlxuXHRcdFx0XHRsZXQgbWVudG9ySWQgPSB1bmlxdWVJZCsrO1xuXHRcdFx0XHRsZXQgbmV3TWVudG9yID0gbmV3IE1lbnRvcihtZW50b3JJZCwgb3B0aW9ucy5uYW1lLCBvcHRpb25zLnByZWZlcnJlZFN0dWRlbnRzTGlzdClcblx0XHRcdFx0TGliLm1lbnRvcnMucHVzaChuZXdNZW50b3IpO1xuXHRcdFx0XHRjb25zb2xlLmxvZygnQWRkZWQgbmV3IE1lbnRvcjogJysgbmV3TWVudG9yLm5hbWUgKycuJyk7XG5cdFx0XHRcdHJldHVybiBuZXdNZW50b3I7XG5cdFx0XHRicmVhaztcblxuXHRcdFx0Ly8g0JXRgdC70Lgg0YLQuNC/INC30LDQtNCw0L0g0L3QtdCy0LXRgNC90L5cblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcign0KLQuNC/0LAgXFwnJysgdHlwZSArJ1xcJyDQvdC1INGB0YPRidC10YHRgtCy0YPQtdGCLicpO1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9LFxuXG5cdGVkaXQ6IGZ1bmN0aW9uKHNlbGVjdG9yLCBvcHRpb25zKSB7XG5cblx0XHQvLyDQntCx0YDQsNCx0L7RgtC60LAg0L7RiNC40LHQvtC6XG5cdFx0aWYgKCh0eXBlb2Ygc2VsZWN0b3IgPT09ICd1bmRlZmluZWQnKSB8fCAoc2VsZWN0b3IubGVuZ3RoID09IDApKVxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQodC10LvQtdC60YLQvtGAINC00L7Qu9C20LXQvSDQsdGL0YLRjCDRg9C60LDQt9Cw0L0uJylcblx0XHRlbHNlIGlmICgodHlwZW9mIHNlbGVjdG9yICE9ICdzdHJpbmcnKSAmJiAodHlwZW9mIHNlbGVjdG9yICE9ICdudW1iZXInKSlcblx0XHRcdHRocm93IG5ldyBFcnJvcign0KHQtdC70LXQutGC0L7RgCDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0YHRgtGA0L7QutC+0Lkg0LjQu9C4INGH0LjRgdC70L7QvCcpO1xuXHRcdFxuXHRcdGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ3VuZGVmaW5lZCcpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Ce0YLRgdGD0YLRgdGC0LLRg9C10YIgXFwnb3B0aW9uc1xcJy4g0JfQsNC00LDQudGC0LUg0LXQs9C+INGF0L7RgtGPINCx0Ysg0YEg0L7QtNC90LjQvCDRgdCy0L7QudGB0YLQstC+0LwuJylcblx0XHRlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucyAhPSAnb2JqZWN0Jylcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3B0aW9ucyDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0L7QsdGK0LXQutGC0L7QvCB7fS4nKTtcblxuXHRcdC8vINCf0YDQsNCy0LrQsCDQvtCx0YrQtdC60YLQsFxuXHRcdHZhciBvYmplY3QgPSB0aGlzLnNlbGVjdChzZWxlY3Rvcik7XG5cdFx0Zm9yIChsZXQgcHJvcCBpbiBvcHRpb25zKSB7XG5cdFx0XHRpZiAocHJvcCA9PSAnaWQnKSBjb250aW51ZTtcblx0XHRcdG9iamVjdFtwcm9wXSA9IG9wdGlvbnNbcHJvcF07XG5cdFx0fVxuXHRcdHJldHVybiBvYmplY3Q7XG5cblx0fSxcblxuXHRzdHVkZW50czogW10sXG5cdG1lbnRvcnM6IFtdLFxuXHR0YXNrczogW10sXG5cdHRlYW1zOiBbXSxcblxuXHRzZWxlY3Q6IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG5cdFx0dmFyIHJlc3VsdCA9IHVuZGVmaW5lZDtcblx0XHRpZiAoKHR5cGVvZiBzZWxlY3RvciA9PT0gJ251bWJlcicpIHx8ICFpc05hTihzZWxlY3RvcikpIHtcblx0XHRcdHZhciBzZWxlY3RvciA9IHBhcnNlSW50KHNlbGVjdG9yKTtcblxuXHRcdFx0TGliLnN0dWRlbnRzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKSB7XG5cdFx0XHRcdGlmICgoaXRlbS5pZCA9PSBzZWxlY3RvcikgJiYgIXJlc3VsdCkge1xuXHRcdFx0XHRcdHJlc3VsdCA9IGl0ZW07XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aWYgKHJlc3VsdCkgcmV0dXJuIHJlc3VsdDtcblxuXHRcdFx0XG5cdFx0XHRMaWIubWVudG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycikge1xuXHRcdFx0XHRpZiAoKGl0ZW0uaWQgPT0gc2VsZWN0b3IpICYmICFyZXN1bHQpIHtcblx0XHRcdFx0XHRyZXN1bHQgPSBpdGVtO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdGlmIChyZXN1bHQpIHJldHVybiByZXN1bHQ7XG5cdFx0XHRcblx0XHRcdFxuXHRcdFx0TGliLnRhc2tzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKSB7XG5cdFx0XHRcdGlmICgoaXRlbS5pZCA9PSBzZWxlY3RvcikgJiYgIXJlc3VsdCkge1xuXHRcdFx0XHRcdHJlc3VsdCA9IGl0ZW07XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aWYgKHJlc3VsdCkgcmV0dXJuIHJlc3VsdDtcblx0XHRcdFxuXHRcdFx0XG5cdFx0XHRMaWIudGVhbXMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0aWYgKChpdGVtLmlkID09IHNlbGVjdG9yKSAmJiAhcmVzdWx0KSB7XG5cdFx0XHRcdFx0cmVzdWx0ID0gaXRlbTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRpZiAocmVzdWx0KSByZXR1cm4gcmVzdWx0O1xuXHRcdFx0XG5cblx0XHR9IGVsc2UgaWYgKHR5cGVvZiBzZWxlY3RvciA9PSAnc3RyaW5nJykge1xuXG5cdFx0XHRMaWIuc3R1ZGVudHMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0aWYgKChpdGVtLm5hbWUgPT0gc2VsZWN0b3IpICYmICFyZXN1bHQpIHtcblx0XHRcdFx0XHRyZXN1bHQgPSBpdGVtO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdGlmIChyZXN1bHQpIHJldHVybiByZXN1bHQ7XG5cblx0XHRcdFxuXHRcdFx0TGliLm1lbnRvcnMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0aWYgKChpdGVtLm5hbWUgPT0gc2VsZWN0b3IpICYmICFyZXN1bHQpIHtcblx0XHRcdFx0XHRyZXN1bHQgPSBpdGVtO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdGlmIChyZXN1bHQpIHJldHVybiByZXN1bHQ7XG5cdFx0XHRcblx0XHRcdFxuXHRcdFx0TGliLnRhc2tzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKSB7XG5cdFx0XHRcdGlmICgoaXRlbS50aXRsZSA9PSBzZWxlY3RvcikgJiYgIXJlc3VsdCkge1xuXHRcdFx0XHRcdHJlc3VsdCA9IGl0ZW07XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aWYgKHJlc3VsdCkgcmV0dXJuIHJlc3VsdDtcblx0XHRcdFxuXHRcdFx0XG5cdFx0XHRMaWIudGVhbXMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0aWYgKChpdGVtLm5hbWUgPT0gc2VsZWN0b3IpICYmICFyZXN1bHQpIHtcblx0XHRcdFx0XHRyZXN1bHQgPSBpdGVtO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdGlmIChyZXN1bHQpIHJldHVybiByZXN1bHQ7XG5cblx0XHR9IGVsc2UgaWYgKHNlbGVjdG9yIGluc3RhbmNlb2YgTGliT2JqZWN0KSB7XG5cdFx0XHRyZXR1cm4gc2VsZWN0b3I7XG5cdFx0fVxuXG5cdFx0aWYgKHJlc3VsdCA9PSB1bmRlZmluZWQpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdC8vIHRocm93IG5ldyBFcnJvcign0J7QsdGK0LXQutGCICcrc2VsZWN0b3IrJyDQvdC1INC90LDQudC00LXQvScpO1xuXHRcdH1cblx0XHRyZXR1cm4gcmVzdWx0O1xuXG5cdH1cbn07XG5cbnZhciB1c2VyID0gbmV3IFN0dWRlbnQoJ9Cd0LjQutC40YLQsCcpO1xud2luZG93LkxpYiA9IExpYjtcbi8vIExpYi5zdHVkZW50cy5wdXNoKG5ldyBTdHVkZW50KCfQndC40LrQuNGC0LAnKSk7XG4vLyBMaWIuc3R1ZGVudHMucHVzaChuZXcgU3R1ZGVudCgn0JvQtdGB0Y8nKSk7XG59KSgpOyIsImNsYXNzIFN0dWRlbnQgZXh0ZW5kcyBMaWJPYmplY3Qge1xuXHRjb25zdHJ1Y3RvcihuZXdJZCwgbmV3TmFtZSwgbmV3TWVudG9ycywgbmV3VGVhbSkge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy5zdHVkZW50SWQgPSBuZXdJZDtcblx0XHR0aGlzLnN0dWRlbnRUYXNrcyA9IFtdO1xuXHRcdHRoaXMubmFtZSA9IG5ld05hbWU7XG5cdFx0Ly8gaWYgKG5ld1RlYW0gIT09IHVuZGVmaW5lZCkgdGhpcy50ZWFtID0gbmV3VGVhbTtcblx0XHR0aGlzLnByZWZlcnJlZE1lbnRvcnNMaXN0ID0gKG5ld01lbnRvcnMgIT09IHVuZGVmaW5lZClcblx0XHRcdD8gbmV3TWVudG9yc1xuXHRcdFx0OiBbXTtcblx0fVxuXG5cblx0c2V0IGlkKG5ld0lkKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCfQndC10LvRjNC30Y8g0LzQtdC90Y/RgtGMIElELicpO1xuXHRcdHJldHVybjtcblx0fVxuXHRnZXQgaWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMuc3R1ZGVudElkO1xuXHR9XG5cblx0c2V0IG5hbWUoc3RyKSB7XG5cdFx0dGhpcy5zdHVkZW50TmFtZSA9IHN0cjtcblx0fVxuXHRnZXQgbmFtZSgpe1xuXHRcdHJldHVybiB0aGlzLnN0dWRlbnROYW1lO1xuXHR9XG5cblx0c2V0IHRlYW0ob2JqKSB7XG5cdFx0dGhpcy5zdHVkZW50VGVhbSA9IG9iajtcblx0fVxuXHRnZXQgdGVhbSgpIHtcblx0XHRyZXR1cm4gdGhpcy5zdHVkZW50VGVhbTtcblx0fVxuXG5cdHNldCBwcmVmZXJyZWRNZW50b3JzTGlzdChhcnIpIHtcblx0XHRpZiAodHlwZW9mIGFyciAhPT0gdHlwZW9mIFtdICkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQodC/0LjRgdC+0Log0LTQvtC70LbQtdC9INCx0YvRgtGMINC80LDRgdGB0LjQstC+0LwuJyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0YXJyID0gYXJyLm1hcChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0bGV0IG1lbnRvciA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIShtZW50b3IgaW5zdGFuY2VvZiBNZW50b3IpKSBtZW50b3IgPSBmYWxzZTtcblx0XHRcdHJldHVybiBtZW50b3I7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnN0dWRlbnRQcmVmZXJyZWRNZW50b3JzTGlzdCA9IGFyci5maWx0ZXIoZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGlmIChpdGVtID09PSBmYWxzZSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRnZXQgcHJlZmVycmVkTWVudG9yc0xpc3QoKSB7XG5cdFx0dGhpcy5zdHVkZW50UHJlZmVycmVkTWVudG9yc0xpc3Q7XG5cdH1cblxuXHRhZGRUYXNrcyh0YXNrcywgc3RvcCA9IGZhbHNlKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdGlmICh0YXNrcyBpbnN0YW5jZW9mIFRhc2spIHtcblx0XHRcdGZvciAobGV0IGl0ZW0gaW4gdGhpcy5zdHVkZW50VGFza3MpIHtcblx0XHRcdFx0aWYgKHRhc2tzID09IGl0ZW0udGFzaykgcmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0bGV0IHRhc2tSZWNvcmQgPSB7XG5cdFx0XHRcdHRhc2s6IHRhc2tzLFxuXHRcdFx0XHRtYXJrOiAwXG5cdFx0XHR9XG5cdFx0XHR0aGlzLnN0dWRlbnRUYXNrcy5wdXNoKHRhc2tSZWNvcmQpO1x0XG5cdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0dGFza3MuYWRkRXhlY3V0b3JzKHRoaXMsIHRydWUpO1xuXHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh0YXNrcykpIHtcblx0XHRcdHRhc2tzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdFx0aWYgKGl0ZW0gaW5zdGFuY2VvZiBUYXNrKSB7XG5cdFx0XHRcdFx0Zm9yIChsZXQgaW5uZXJJdGVtIGluIHNlbGYuc3R1ZGVudFRhc2tzKSB7XG5cdFx0XHRcdFx0XHRpZiAoaXRlbSA9PSBpbm5lckl0ZW0udGFzaykgcmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRsZXQgdGFza1JlY29yZCA9IHtcblx0XHRcdFx0XHRcdHRhc2s6IGl0ZW0sXG5cdFx0XHRcdFx0XHRtYXJrOiAwXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHNlbGYuc3R1ZGVudFRhc2tzLnB1c2godGFza1JlY29yZCk7XG5cdFx0XHRcdFx0aWYgKHN0b3ApIHJldHVybjtcblx0XHRcdFx0XHRpdGVtLmFkZEV4ZWN1dG9ycyhzZWxmLCB0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0cmVtb3ZlVGFza3MoYXJyKSB7XG5cdFx0bGV0IHNlbGYgPSB0aGlzO1xuXHRcdGFyci5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgdGFzayA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIXRhc2spIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ9Ch0YLRg9C00LXQvdGCICcrIGl0ZW0gKycg0L3QtSDQvdCw0LnQtNC10L0uJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGxldCBpbmRleCA9IHNlbGYuc3R1ZGVudFRhc2tzLmluZGV4T2YodGFzayk7XG5cdFx0XHRpZiAoaW5kZXggIT09IC0xKSB7XG5cdFx0XHRcdHNlbGYuc3R1ZGVudFRhc2tzLnNwbGljZShpbmRleCwxKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdHNldE1hcmsoc2VsZWN0b3IsIG1hcmspIHtcblx0XHRsZXQgdGFzayA9IExpYi5zZWxlY3Qoc2VsZWN0b3IpO1xuXHRcdGlmICghdGFzayB8fCAhKHRhc2sgaW5zdGFuY2VvZiBUYXNrKSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQl9Cw0LTQsNC90LjQtSAnK3NlbGVjdG9yKycg0L3QtSDQvdCw0LnQtNC10L3Qvi4nKTtcblx0XHR9XG5cdFx0dGhpcy5zdHVkZW50VGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0aWYgKGl0ZW0udGFzayA9PSB0YXNrKSB7XG5cdFx0XHRcdGl0ZW0ubWFyayA9IG1hcms7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG59IiwiY2xhc3MgVGFzayBleHRlbmRzIExpYk9iamVjdCB7XG5cdGNvbnN0cnVjdG9yKG5ld0lkLCBuZXdUaXRsZSwgbmV3Q29udGVudCwgbmV3RXhlY3V0b3JzKSB7XG5cdFx0c3VwZXIoKTtcblx0XHR0aGlzLnRhc2tJZCA9IG5ld0lkO1xuXHRcdHRoaXMudGl0bGUgPSBuZXdUaXRsZTtcblx0XHR0aGlzLmNvbnRlbnQgPSBuZXdDb250ZW50O1xuXHRcdHRoaXMudGFza0V4ZWN1dG9ycyA9IChuZXdFeGVjdXRvcnMgIT09IHVuZGVmaW5lZClcblx0XHRcdD8gbmV3RXhlY3V0b3JzXG5cdFx0XHQ6IFtdO1xuXHR9XG5cblx0c2V0IGlkKG5ld0lkKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCfQndC10LvRjNC30Y8g0LzQtdC90Y/RgtGMIElELicpO1xuXHRcdHJldHVybjtcblx0fVxuXHRnZXQgaWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMudGFza0lkO1xuXHR9XG5cblx0c2V0IHRpdGxlKHN0cikge1xuXHRcdHRoaXMudGFza1RpdGxlID0gc3RyO1xuXHR9XG5cdGdldCB0aXRsZSgpe1xuXHRcdHJldHVybiB0aGlzLnRhc2tUaXRsZTtcblx0fVxuXG5cdHNldCBjb250ZW50KHN0cikge1xuXHRcdHRoaXMudGFza0NvbnRlbnQgPSBzdHI7XG5cdH1cblx0Z2V0IGNvbnRlbnQoKSB7XG5cdFx0cmV0dXJuIHRoaXMudGFza0NvbnRlbnQ7XG5cdH1cblxuXHQvLyBzZXQgZXhlY3V0b3JzKGFycikge1xuXHQvLyBcdHRoaXMudGFza0V4ZWN1dG9ycyA9IGFycjtcblx0Ly8gfVxuXHRnZXQgZXhlY3V0b3JzKCkge1xuXHRcdHJldHVybiB0aGlzLnRhc2tFeGVjdXRvcnNcblx0fVxuXG5cdGFkZEV4ZWN1dG9ycyhleGVjdXRvcnMsIHN0b3AgPSBmYWxzZSkge1xuXHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRpZiAoZXhlY3V0b3JzIGluc3RhbmNlb2YgTGliT2JqZWN0KSB7XG5cdFx0XHRpZiAoZXhlY3V0b3JzIGluIHRoaXMudGFza0V4ZWN1dG9ycykgcmV0dXJuO1xuXHRcdFx0dGhpcy50YXNrRXhlY3V0b3JzLnB1c2goZXhlY3V0b3JzKTtcblx0XHRcdGlmIChzdG9wKSByZXR1cm47XG5cdFx0XHRleGVjdXRvcnMuYWRkVGFza3ModGhpcywgdHJ1ZSk7XG5cdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGV4ZWN1dG9ycykpIHtcblx0XHRcdGV4ZWN1dG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRcdGlmIChpdGVtIGluIHNlbGYudGFza0V4ZWN1dG9ycykgcmV0dXJuO1xuXHRcdFx0XHRzZWxmLnRhc2tFeGVjdXRvcnMucHVzaChpdGVtKTtcblx0XHRcdFx0aWYgKHN0b3ApIHJldHVybjtcblx0XHRcdFx0aXRlbS5hZGRUYXNrcyhzZWxmLCB0cnVlKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdHJlbW92ZUV4ZWN1dG9ycyhhcnIpIHtcblx0XHRsZXQgc2VsZiA9IHRoaXM7XG5cdFx0YXJyLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGxldCBleGVjdXRvciA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIWV4ZWN1dG9yKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCfQodGC0YPQtNC10L3RgiAnKyBpdGVtICsnINC90LUg0L3QsNC50LTQtdC9LicpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRsZXQgaW5kZXggPSBzZWxmLnRhc2tFeGVjdXRvcnMuaW5kZXhPZihleGVjdXRvcik7XG5cdFx0XHRpZiAoaW5kZXggIT09IC0xKSB7XG5cdFx0XHRcdHNlbGYudGFza0V4ZWN1dG9ycy5zcGxpY2UoaW5kZXgsMSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxufSIsImNsYXNzIFRlYW0gZXh0ZW5kcyBMaWJPYmplY3Qge1xuXHRjb25zdHJ1Y3RvcihuZXdJZCwgbmV3TmFtZSwgbmV3VGVhbW1hdGVzKSB7XG5cdFx0c3VwZXIoKTtcblx0XHR0aGlzLnRlYW1JZCA9IG5ld0lkO1xuXHRcdHRoaXMubmFtZSA9IG5ld05hbWU7XG5cdFx0dGhpcy50ZWFtVGFza3MgPSBbXTtcblx0XHR0aGlzLnRlYW1tYXRlcyA9IChuZXdUZWFtbWF0ZXMgIT09IHVuZGVmaW5lZCkgXG5cdFx0XHQ/IG5ld1RlYW1tYXRlc1xuXHRcdFx0OiBbXTtcblx0fVxuXG5cdHNldCBpZChuZXdJZCkge1xuXHRcdHRocm93IG5ldyBFcnJvcign0J3QtdC70YzQt9GPINC80LXQvdGP0YLRjCBJRC4nKTtcblx0XHRyZXR1cm47XG5cdH1cblx0Z2V0IGlkKCkge1xuXHRcdHJldHVybiB0aGlzLnRlYW1JZDtcblx0fVxuXG5cdHNldCBuYW1lKHN0cikge1xuXHRcdHRoaXMudGVhbU5hbWUgPSBzdHI7XG5cdH1cblx0Z2V0IG5hbWUoKXtcblx0XHRyZXR1cm4gdGhpcy50ZWFtTmFtZTtcblx0fVxuXG5cdHNldCB0ZWFtbWF0ZXMoYXJyKSB7XG5cdFx0dGhpcy50ZWFtVGVhbW1hdGVzID0gYXJyO1xuXHR9XG5cdGdldCB0ZWFtbWF0ZXMoKSB7XG5cdFx0cmV0dXJuIHRoaXMudGVhbVRlYW1tYXRlcztcblx0fVxuXG5cdGFkZFRlYW1tYXRlcyhzdHVkZW50cykge1xuXHRcdGlmIChzdHVkZW50cyBpbnN0YW5jZW9mIExpYk9iamVjdCkge1xuXHRcdFx0dGhpcy50ZWFtVGVhbW1hdGVzLnB1c2goc3R1ZGVudHMpO1x0XG5cdFx0fSBlbHNlIGlmIChpc0FycmF5KHN0dWRlbnRzKSkge1xuXHRcdFx0c3R1ZGVudHMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0XHR0aGlzLnRlYW1UZWFtbWF0ZXMucHVzaChpdGVtKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdHJlbW92ZVRlYW1tYXRlcyhhcnIpIHtcblx0XHRsZXQgc2VsZiA9IHRoaXM7XG5cdFx0YXJyLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGxldCBzdHVkZW50ID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdGlmICghc3R1ZGVudCkgY29uc29sZS5sb2coJ9Ch0YLRg9C00LXQvdGCICcrIGl0ZW0gKycg0L3QtSDQvdCw0LnQtNC10L0uJyk7XG5cdFx0XHRsZXQgaW5kZXggPSBzZWxmLnRlYW1UZWFtbWF0ZXMuaW5kZXhPZihzdHVkZW50KTtcblx0XHRcdGlmIChpbmRleCAhPT0gLTEpIHtcblx0XHRcdFx0c2VsZi50ZWFtVGVhbW1hdGVzLnNwbGljZShpbmRleCwxKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdGFkZFRhc2tzKHRhc2tzLCBzdG9wID0gZmFsc2UpIHtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0aWYgKHRhc2tzIGluc3RhbmNlb2YgTGliT2JqZWN0KSB7XG5cdFx0XHRmb3IgKGxldCBpdGVtIGluIHNlbGYuc3R1ZGVudFRhc2tzKSB7XG5cdFx0XHRcdGlmICh0YXNrcyA9PSBpdGVtLnRhc2spIHJldHVybjtcblx0XHRcdH1cblx0XHRcdGxldCB0YXNrUmVjb3JkID0ge1xuXHRcdFx0XHR0YXNrOiB0YXNrcyxcblx0XHRcdFx0bWFyazogMFxuXHRcdFx0fVxuXHRcdFx0dGhpcy50ZWFtVGFza3MucHVzaCh0YXNrUmVjb3JkKTtcblx0XHRcdGlmIChzdG9wKSByZXR1cm47XG5cdFx0XHR0YXNrcy5hZGRFeGVjdXRvcnModGhpcywgdHJ1ZSk7XG5cdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHRhc2tzKSkge1xuXHRcdFx0dGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0XHRpZiAoaXRlbSBpbnN0YW5jZW9mIFRhc2spIHtcblx0XHRcdFx0XHRmb3IgKGxldCBpbm5lckl0ZW0gaW4gc2VsZi50ZWFtVGFza3MpIHtcblx0XHRcdFx0XHRcdGlmIChpdGVtID09IGlubmVySXRlbS50YXNrKSByZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGxldCB0YXNrUmVjb3JkID0ge1xuXHRcdFx0XHRcdFx0dGFzazogaXRlbSxcblx0XHRcdFx0XHRcdG1hcms6IDBcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0c2VsZi50ZWFtVGFza3MucHVzaCh0YXNrUmVjb3JkKTtcblx0XHRcdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0XHRcdGl0ZW0uYWRkRXhlY3V0b3JzKHNlbGYsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRyZW1vdmVUYXNrcyhhcnIpIHtcblx0XHRsZXQgc2VsZiA9IHRoaXM7XG5cdFx0YXJyLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGxldCB0YXNrID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdGlmICghdGFzaykge1xuXHRcdFx0XHRjb25zb2xlLmxvZygn0KHRgtGD0LTQtdC90YIgJysgaXRlbSArJyDQvdC1INC90LDQudC00LXQvS4nKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0bGV0IGluZGV4ID0gc2VsZi50ZWFtVGFza3MuaW5kZXhPZih0YXNrKTtcblx0XHRcdGlmIChpbmRleCAhPT0gLTEpIHtcblx0XHRcdFx0c2VsZi50ZWFtVGFza3Muc3BsaWNlKGluZGV4LDEpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0c2V0TWFyayhzZWxlY3RvciwgbWFyaykge1xuXHRcdGxldCB0YXNrID0gTGliLnNlbGVjdChzZWxlY3Rvcik7XG5cdFx0aWYgKCF0YXNrIHx8ICEodGFzayBpbnN0YW5jZW9mIFRhc2spKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9CX0LDQtNCw0L3QuNC1ICcrc2VsZWN0b3IrJyDQvdC1INC90LDQudC00LXQvdC+LicpO1xuXHRcdH1cblx0XHR0aGlzLnRlYW1UYXNrcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycikge1xuXHRcdFx0aWYgKGl0ZW0udGFzayA9PSB0YXNrKSB7XG5cdFx0XHRcdGl0ZW0ubWFyayA9IG1hcms7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxufSIsImNsYXNzIE1lbnRvciBleHRlbmRzIExpYk9iamVjdCB7XG5cdGNvbnN0cnVjdG9yKG5ld0lkLCBuZXdOYW1lLCBuZXdQcmVmZXJyZWRTdHVkZW50c0xpc3QpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMubWVudG9ySWQgPSBuZXdJZDtcblx0XHR0aGlzLm5hbWUgPSBuZXdOYW1lO1xuXHRcdHRoaXMucHJlZmVycmVkU3R1ZGVudHNMaXN0ID0gKG5ld1ByZWZlcnJlZFN0dWRlbnRzTGlzdCAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0PyBuZXdQcmVmZXJyZWRTdHVkZW50c0xpc3Rcblx0XHRcdDogW107XG5cdH1cblxuXHRzZXQgaWQobmV3SWQpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Cd0LXQu9GM0LfRjyDQvNC10L3Rj9GC0YwgSUQuJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGdldCBpZCgpIHtcblx0XHRyZXR1cm4gdGhpcy5tZW50b3JJZDtcblx0fVxuXG5cdHNldCBuYW1lKHN0cikge1xuXHRcdHRoaXMubWVudG9yTmFtZSA9IHN0cjtcblx0fVxuXHRnZXQgbmFtZSgpe1xuXHRcdHJldHVybiB0aGlzLm1lbnRvck5hbWU7XG5cdH1cblxuXHRzZXQgcHJlZmVycmVkU3R1ZGVudHNMaXN0KGFycikge1xuXHRcdGlmICh0eXBlb2YgYXJyICE9PSB0eXBlb2YgW10gKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Ch0L/QuNGB0L7QuiDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0LzQsNGB0YHQuNCy0L7QvC4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRhcnIgPSBhcnIubWFwKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgc3R1ZGVudCA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIShzdHVkZW50IGluc3RhbmNlb2YgU3R1ZGVudCkpIHN0dWRlbnQgPSBmYWxzZTtcblx0XHRcdHJldHVybiBzdHVkZW50O1xuXHRcdH0pO1xuXG5cdFx0Ly8gdGhpcy5tZW50b3JQcmVmZXJyZWRTdHVkZW50c0xpc3QgPSBhcnI7XG5cblx0XHR0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdCA9IGFyci5maWx0ZXIoZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGlmIChpdGVtID09PSBmYWxzZSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRnZXQgcHJlZmVycmVkU3R1ZGVudHNMaXN0KCkge1xuXHRcdHJldHVybiB0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdDtcblx0fVxuXHRcbn0iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=

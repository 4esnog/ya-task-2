"use strict";function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();!function(){var e=function a(){_classCallCheck(this,a)},t=function(e){function t(e,r,n,s){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return i.studentId=e,i.studentTasks=[],i.name=r,i.preferredMentorsList=void 0!==n?n:[],i}return _inherits(t,e),_createClass(t,[{key:"addPreferredMentor",value:function(e,t){if("number"!=typeof t&&isNaN(e))throw new Error("Приоритет должен быть числом.");if(t=parseInt(t),e instanceof s||(e=o.select(selector)),!(e instanceof s))throw new Error("В список менторов можно добавлять только менторов.");var r=this.studentPreferredMentorsList.indexOf(e);return-1!==r&&this.studentPreferredMentorsList.splice(r,1),this.studentPreferredMentorsList.splice(t-1,0,e),this}},{key:"addTasks",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=this,s=!1;if(e instanceof r){if(this.studentTasks.forEach(function(t,r,n){e==t.task&&(s=!0)}),s)return;var i={task:e,mark:0};if(this.studentTasks.push(i),t)return;e.addExecutors(this,!0)}else Array.isArray(e)&&e.forEach(function(e,r,i){if(e=o.select("item"),n.studentTasks.forEach(function(t,r,n){e==t.task&&(s=!0)}),!s){var a={task:e,mark:0};n.studentTasks.push(a),t||e.addExecutors(n,!0)}});return this}},{key:"removeTasks",value:function(e){var t=this;return e.forEach(function(e,r,n){var s=o.select(e);if(!s)return void console.log("Задание "+e+" не найдено.");var i=t.studentTasks.indexOf(s);-1!==i&&t.studentTasks.splice(i,1)}),this}},{key:"setMark",value:function(e,t){var n=o.select(e);if(!(n&&n instanceof r))throw new Error("Задание "+e+" не найдено.");return this.studentTasks.forEach(function(e,r,s){e.task==n&&(e.mark=t)}),this}},{key:"id",set:function(e){throw new Error("Нельзя менять ID.")},get:function(){return this.studentId}},{key:"name",set:function(e){this.studentName=e},get:function(){return this.studentName}},{key:"team",set:function(e){this.studentTeam=e},get:function(){return this.studentTeam}},{key:"preferredMentorsList",set:function(e){if(!Array.isArray(e))throw new Error("Список должен быть массивом.");e=e.map(function(e,t,r){var n=o.select(e);return n instanceof s||(n=!1),n}),this.studentPreferredMentorsList=e.filter(function(e,t,r){return e!==!1})},get:function(){return this.studentPreferredMentorsList}}]),t}(e),r=function(e){function r(e,t,n,s){_classCallCheck(this,r);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(r).call(this));return i.taskId=e,i.title=t,i.content=n,i.taskExecutors=void 0!==s?s:[],i}return _inherits(r,e),_createClass(r,[{key:"addExecutors",value:function(e){var r=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],s=this;if(e instanceof t||item instanceof n){if(e in this.taskExecutors)return;if(this.taskExecutors.push(e),r)return;e.addTasks(this,!0)}else Array.isArray(e)&&e.forEach(function(e,i,a){if(e=o.select(e),!(e instanceof t&&e instanceof n))throw new Error("Задание можно дать только студенту или команде");e in s.taskExecutors||(s.taskExecutors.push(e),r||e.addTasks(s,!0))});return this}},{key:"removeExecutors",value:function(e){var t=this;return e.forEach(function(e,r,n){var s=o.select(e);if(!s)return void console.log("Студент "+e+" не найден.");var i=t.taskExecutors.indexOf(s);-1!==i&&t.taskExecutors.splice(i,1)}),this}},{key:"id",set:function(e){throw new Error("Нельзя менять ID.")},get:function(){return this.taskId}},{key:"title",set:function(e){this.taskTitle=e},get:function(){return this.taskTitle}},{key:"content",set:function(e){this.taskContent=e},get:function(){return this.taskContent}},{key:"executors",get:function(){return this.taskExecutors}}]),r}(e),n=function(n){function s(e,t,r){_classCallCheck(this,s);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(s).call(this));return n.teamId=e,n.name=t,n.teamTasks=[],n.teammates=void 0!==r?r:[],n}return _inherits(s,n),_createClass(s,[{key:"addTeammates",value:function(r){return r instanceof e?this.teamTeammates.push(r):Array.isArray(r)&&r.forEach(function(e,r,n){if(e=o.select(e),!(e instanceof t))throw new Error("В команду можно добавить только студентов");this.teamTeammates.push(e)}),this}},{key:"removeTeammates",value:function(e){var t=this;return e.forEach(function(e,r,n){var s=o.select(e);s||console.log("Студент "+e+" не найден.");var i=t.teamTeammates.indexOf(s);-1!==i&&t.teamTeammates.splice(i,1)}),this}},{key:"addTasks",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=this,s=!1;if(e instanceof r){if(n.studentTasks.forEach(function(t,r,n){e==t.task&&(s=!0)}),s)return;var i={task:e,mark:0};if(this.teamTasks.push(i),t)return;e.addExecutors(this,!0)}else Array.isArray(e)&&e.forEach(function(e,r,i){if(e=o.select("item"),n.teamTasks.forEach(function(t,r,n){e==t.task&&(s=!0)}),!s){var a={task:e,mark:0};n.teamTasks.push(a),t||e.addExecutors(n,!0)}});return this}},{key:"removeTasks",value:function(e){var t=this;return e.forEach(function(e,r,n){var s=o.select(e);if(!s)return void console.log("Студент "+e+" не найден.");var i=t.teamTasks.indexOf(s);-1!==i&&t.teamTasks.splice(i,1)}),this}},{key:"setMark",value:function(e,t){var n=o.select(e);if(!(n instanceof r))throw new Error("Задание "+e+" не найдено.");return this.teamTasks.forEach(function(e,r,s){e.task==n&&(e.mark=t)}),this}},{key:"id",set:function(e){throw new Error("Нельзя менять ID.")},get:function(){return this.teamId}},{key:"name",set:function(e){this.teamName=e},get:function(){return this.teamName}},{key:"teammates",set:function(e){this.teamTeammates=e},get:function(){return this.teamTeammates}}]),s}(e),s=function(e){function r(e,t,n){_classCallCheck(this,r);var s=_possibleConstructorReturn(this,Object.getPrototypeOf(r).call(this));return s.mentorId=e,s.name=t,s.preferredStudentsList=void 0!==n?n:[],s}return _inherits(r,e),_createClass(r,[{key:"addPreferredStudent",value:function(e,r){if("number"!=typeof r&&isNaN(e))throw new Error("Приоритет должен быть числом.");if(r=parseInt(r),e instanceof t||(e=o.select(e)),!(e instanceof t))throw new Error("В список студентов можно добавлять только студентов.");var n=this.mentorPreferredStudentsList.indexOf(e);return-1!==n&&this.mentorPreferredStudentsList.splice(n,1),this.mentorPreferredStudentsList.splice(r-1,0,e),this}},{key:"id",set:function(e){throw new Error("Нельзя менять ID.")},get:function(){return this.mentorId}},{key:"name",set:function(e){this.mentorName=e},get:function(){return this.mentorName}},{key:"preferredStudentsList",set:function(e){if(("undefined"==typeof e?"undefined":_typeof(e))!==_typeof([]))throw new Error("Список должен быть массивом.");e=e.map(function(e,r,n){var s=o.select(e);return s instanceof t||(s=!1),s}),this.mentorPreferredStudentsList=e.filter(function(e,t,r){return e!==!1})},get:function(){return this.mentorPreferredStudentsList}}]),r}(e),i=0,o={add:function(e,a){if("undefined"==typeof e||0==e.length)throw new Error("Тип должен быть указан.");if("string"!=typeof e)throw new Error("Тип должен быть строкой");if("undefined"==typeof a||!("name"in a||"title"in a))throw new Error("Отсутствует 'options'. Задайте его хотя бы с одним свойством 'name' или 'title'.");if("object"!=("undefined"==typeof a?"undefined":_typeof(a)))throw new Error("Options должен быть объектом {}.");switch(e){case"student":var u=i++,f=new t(u,a.name,a.preferredMentorsList);if(a.team){var c=this.select(a.team);c||(c=o.add("team",{name:a.team})),f.team=c,c.addTeammates(f,!0)}return o.students.push(f),console.log("Added new Student: "+f.name+"."),f;case"task":var d=i++,h=new r(d,a.title,a.content);if(a.executors){var l=a.executors.map(function(e,r,s){var i=o.select(e);if(!i)throw new Error("Невозможно добавить несуществующего исполнителя "+e+".");if(!(i instanceof t||i instanceof n))throw new Error("Исполнитель должен быть студентом или командой.");return i});h.addExecutors(l)}return o.tasks.push(h),console.log("Added new Task: "+h.title+"."),h;case"team":var m=i++,p=new n(m,a.name);if(a.teammates){var k=a.teammates.map(function(e,r,n){var s=o.select(e);if(!s)throw new Error("Невозможно добавить в команду несуществующего студента "+e+".");if(!(s instanceof t))throw new Error("В команде могут состоять только студенты.");return s});p.addTeammates(k)}return o.teams.push(p),console.log("Added new Team: "+p.name+"."),p;case"mentor":var y=i++,v=new s(y,a.name,a.preferredStudentsList);return o.mentors.push(v),console.log("Added new Mentor: "+v.name+"."),v;default:throw new Error("Типа '"+e+"' не существует.")}},edit:function(e,t){if("undefined"==typeof e||0==e.length)throw new Error("Селектор должен быть указан.");if("string"!=typeof e&&"number"!=typeof e)throw new Error("Селектор должен быть строкой или числом");if("undefined"==typeof t)throw new Error("Отсутствует 'options'. Задайте его хотя бы с одним свойством.");if("object"!=("undefined"==typeof t?"undefined":_typeof(t)))throw new Error("Options должен быть объектом {}.");var r=this.select(e);for(var n in t)"id"!=n&&(r[n]=t[n]);return r},students:[],mentors:[],tasks:[],teams:[],select:function(t){var r=void 0;if("number"!=typeof t&&isNaN(t)){if("string"==typeof t){if(o.students.forEach(function(e,n,s){e.name!=t||r||(r=e)}),r)return r;if(o.mentors.forEach(function(e,n,s){e.name!=t||r||(r=e)}),r)return r;if(o.tasks.forEach(function(e,n,s){e.title!=t||r||(r=e)}),r)return r;if(o.teams.forEach(function(e,n,s){e.name!=t||r||(r=e)}),r)return r}else if(t instanceof e)return t}else{var t=parseInt(t);if(o.students.forEach(function(e,n,s){e.id!=t||r||(r=e)}),r)return r;if(o.mentors.forEach(function(e,n,s){e.id!=t||r||(r=e)}),r)return r;if(o.tasks.forEach(function(e,n,s){e.id!=t||r||(r=e)}),r)return r;if(o.teams.forEach(function(e,n,s){e.id!=t||r||(r=e)}),r)return r}return void 0==r?!1:r},getFinalPriorityList:function(){var e=[];return this.mentors.forEach(function(t,r,n){var s=t.preferredStudentsList,i=[],o=void 0;s.forEach(function(r,n,s){var o=r.preferredMentorsList,a=o.indexOf(t),u=!1;e.forEach(function(e,t,n){e.student==r&&(u=!0)}),-1==a||u||i.push({index:a+n,student:r})}),i.forEach(function(e,t,r){return 0==t?void(o=e):void(e.index<o.index&&(o=e))}),e.push({mentor:t,student:o.student,index:o.index})}),e}};window.Lib=o}(),Lib.add("student",{name:"Tolya",team:"TeamDino"}),Lib.add("student",{name:"Masha",team:"TeamDino"}),Lib.add("student",{name:"Andrew",team:"TeamDino"}),Lib.add("student",{name:"Petya",team:"TeamDino"}),Lib.add("mentor",{name:"Golodnov",preferredStudentsList:[0,2,3,4]}),Lib.add("mentor",{name:"Belaya",preferredStudentsList:[3,4,0,2]}),Lib.add("mentor",{name:"Chesnokov",preferredStudentsList:[4,3,2]}),Lib.select(0).preferredMentorsList=[5,6,7],Lib.select(2).preferredMentorsList=[5,6,7],Lib.select(3).preferredMentorsList=[7,6,5],Lib.select(4).preferredMentorsList=[6,5],console.time("a");var list=Lib.getFinalPriorityList();console.timeEnd("a");
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIiwiU3R1ZGVudC5qcyIsIlRhc2suanMiLCJUZWFtLmpzIiwiTWVudG9yLmpzIl0sIm5hbWVzIjpbIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwic2VsZiIsImNhbGwiLCJSZWZlcmVuY2VFcnJvciIsIl9pbmhlcml0cyIsInN1YkNsYXNzIiwic3VwZXJDbGFzcyIsIlR5cGVFcnJvciIsInByb3RvdHlwZSIsIk9iamVjdCIsImNyZWF0ZSIsImNvbnN0cnVjdG9yIiwidmFsdWUiLCJlbnVtZXJhYmxlIiwid3JpdGFibGUiLCJjb25maWd1cmFibGUiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJfdHlwZW9mIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJvYmoiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiTGliT2JqZWN0IiwidGhpcyIsIlN0dWRlbnQiLCJfTGliT2JqZWN0IiwibmV3SWQiLCJuZXdOYW1lIiwibmV3TWVudG9ycyIsIm5ld1RlYW0iLCJfdGhpcyIsImdldFByb3RvdHlwZU9mIiwic3R1ZGVudElkIiwic3R1ZGVudFRhc2tzIiwibmFtZSIsInByZWZlcnJlZE1lbnRvcnNMaXN0IiwidW5kZWZpbmVkIiwibWVudG9yIiwicHJpb3JpdHkiLCJpc05hTiIsIkVycm9yIiwicGFyc2VJbnQiLCJNZW50b3IiLCJMaWIiLCJzZWxlY3QiLCJzZWxlY3RvciIsIm1lbnRvck9sZEluZGV4Iiwic3R1ZGVudFByZWZlcnJlZE1lbnRvcnNMaXN0IiwiaW5kZXhPZiIsInNwbGljZSIsInRhc2tzIiwic3RvcCIsImFyZ3VtZW50cyIsInRhc2tJc1NldCIsIlRhc2siLCJmb3JFYWNoIiwiaXRlbSIsImFyciIsInRhc2siLCJ0YXNrUmVjb3JkIiwibWFyayIsInB1c2giLCJhZGRFeGVjdXRvcnMiLCJBcnJheSIsImlzQXJyYXkiLCJpbm5lckl0ZW0iLCJjb25zb2xlIiwibG9nIiwiaW5kZXgiLCJzZXQiLCJnZXQiLCJzdHIiLCJzdHVkZW50TmFtZSIsInN0dWRlbnRUZWFtIiwibWFwIiwiZmlsdGVyIiwiX0xpYk9iamVjdDIiLCJuZXdUaXRsZSIsIm5ld0NvbnRlbnQiLCJuZXdFeGVjdXRvcnMiLCJfdGhpczIiLCJ0YXNrSWQiLCJ0aXRsZSIsImNvbnRlbnQiLCJ0YXNrRXhlY3V0b3JzIiwiZXhlY3V0b3JzIiwiVGVhbSIsImFkZFRhc2tzIiwiZXhlY3V0b3IiLCJ0YXNrVGl0bGUiLCJ0YXNrQ29udGVudCIsIl9MaWJPYmplY3QzIiwibmV3VGVhbW1hdGVzIiwiX3RoaXMzIiwidGVhbUlkIiwidGVhbVRhc2tzIiwidGVhbW1hdGVzIiwic3R1ZGVudHMiLCJ0ZWFtVGVhbW1hdGVzIiwic3R1ZGVudCIsInRlYW1OYW1lIiwiX0xpYk9iamVjdDQiLCJuZXdQcmVmZXJyZWRTdHVkZW50c0xpc3QiLCJfdGhpczQiLCJtZW50b3JJZCIsInByZWZlcnJlZFN0dWRlbnRzTGlzdCIsInN0dWRlbnRPbGRJbmRleCIsIm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdCIsIm1lbnRvck5hbWUiLCJ1bmlxdWVJZCIsImFkZCIsInR5cGUiLCJvcHRpb25zIiwic3R1ZElkIiwibmV3U3R1ZGVudCIsInRlYW0iLCJ0ZWFtT2JqIiwiYWRkVGVhbW1hdGVzIiwibmV3VGFzayIsInJlcyIsIm5ld01hdGUiLCJ0ZWFtcyIsIm5ld01lbnRvciIsIm1lbnRvcnMiLCJlZGl0Iiwib2JqZWN0IiwicHJvcCIsInJlc3VsdCIsImlkIiwiZ2V0RmluYWxQcmlvcml0eUxpc3QiLCJmaW5hbEFyciIsIm1lbnRvclN0dWRlbnRzTGlzdCIsImluZGV4ZXMiLCJiZXN0U3R1ZGVudCIsInByZWZTdHVkZW50Iiwic3R1ZGVudEluZGV4IiwicHJlZk1lbnRvcnNMaXN0IiwibWVudG9ySW5kZXgiLCJpc1N0dWRlbnRBZGRlZCIsImN1cnJlbnRTdHVkZW50Iiwid2luZG93IiwidGltZSIsImxpc3QiLCJ0aW1lRW5kIl0sIm1hcHBpbmdzIjoiQUFBQSxZQU1BLFNBQVNBLDRCQUEyQkMsRUFBTUMsR0FBUSxJQUFLRCxFQUFRLEtBQU0sSUFBSUUsZ0JBQWUsNERBQWdFLFFBQU9ELEdBQXlCLGdCQUFUQSxJQUFxQyxrQkFBVEEsR0FBOEJELEVBQVBDLEVBRWxPLFFBQVNFLFdBQVVDLEVBQVVDLEdBQWMsR0FBMEIsa0JBQWZBLElBQTRDLE9BQWZBLEVBQXVCLEtBQU0sSUFBSUMsV0FBVSxpRUFBb0VELEdBQWVELEdBQVNHLFVBQVlDLE9BQU9DLE9BQU9KLEdBQWNBLEVBQVdFLFdBQWFHLGFBQWVDLE1BQU9QLEVBQVVRLFlBQVksRUFBT0MsVUFBVSxFQUFNQyxjQUFjLEtBQWVULElBQVlHLE9BQU9PLGVBQWlCUCxPQUFPTyxlQUFlWCxFQUFVQyxHQUFjRCxFQUFTWSxVQUFZWCxHQUVqZSxRQUFTWSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSWIsV0FBVSxxQ0FSaEgsR0FBSWMsU0FBNEIsa0JBQVhDLFNBQW9ELGdCQUFwQkEsUUFBT0MsU0FBd0IsU0FBVUMsR0FBTyxhQUFjQSxJQUFTLFNBQVVBLEdBQU8sTUFBT0EsSUFBeUIsa0JBQVhGLFNBQXlCRSxFQUFJYixjQUFnQlcsT0FBUyxlQUFrQkUsSUFFdE9DLGFBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdsQixXQUFha0IsRUFBV2xCLGFBQWMsRUFBT2tCLEVBQVdoQixjQUFlLEVBQVUsU0FBV2dCLEtBQVlBLEVBQVdqQixVQUFXLEdBQU1MLE9BQU91QixlQUFlTCxFQUFRSSxFQUFXRSxJQUFL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QUEsR0FBQVQsc0JBQUEsRUFBQSxFQUFBLEdBQ0FRLElBQUFDLE9BQUEsR0FBQVQsc0JBQUEsRUFBQSxFQUFBLEdBQ0FRLElBQUFDLE9BQUEsR0FBQVQsc0JBQUEsRUFBQSxFQUFBLEdBQ0FRLElBQUFDLE9BQUEsR0FBQVQsc0JBQUEsRUFBQSxHQUVBK0IsUUFBQTJFLEtBQUEsSUFDQSxJQUFBQyxNQUFBbkcsSUFBQXNGLHNCQUNBL0QsU0FBQTZFLFFBQUEiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4oZnVuY3Rpb24oKXtcblxuY2xhc3MgTGliT2JqZWN0IHtcblxufVxuXG5jbGFzcyBTdHVkZW50IGV4dGVuZHMgTGliT2JqZWN0IHtcblx0Y29uc3RydWN0b3IobmV3SWQsIG5ld05hbWUsIG5ld01lbnRvcnMsIG5ld1RlYW0pIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMuc3R1ZGVudElkID0gbmV3SWQ7XG5cdFx0dGhpcy5zdHVkZW50VGFza3MgPSBbXTtcblx0XHR0aGlzLm5hbWUgPSBuZXdOYW1lO1xuXHRcdC8vIGlmIChuZXdUZWFtICE9PSB1bmRlZmluZWQpIHRoaXMudGVhbSA9IG5ld1RlYW07XG5cdFx0dGhpcy5wcmVmZXJyZWRNZW50b3JzTGlzdCA9IChuZXdNZW50b3JzICE9PSB1bmRlZmluZWQpXG5cdFx0XHQ/IG5ld01lbnRvcnNcblx0XHRcdDogW107XG5cdH1cblxuXG5cdHNldCBpZChuZXdJZCkge1xuXHRcdHRocm93IG5ldyBFcnJvcign0J3QtdC70YzQt9GPINC80LXQvdGP0YLRjCBJRC4nKTtcblx0XHRyZXR1cm47XG5cdH1cblx0Z2V0IGlkKCkge1xuXHRcdHJldHVybiB0aGlzLnN0dWRlbnRJZDtcblx0fVxuXG5cdHNldCBuYW1lKHN0cikge1xuXHRcdHRoaXMuc3R1ZGVudE5hbWUgPSBzdHI7XG5cdH1cblx0Z2V0IG5hbWUoKXtcblx0XHRyZXR1cm4gdGhpcy5zdHVkZW50TmFtZTtcblx0fVxuXG5cdHNldCB0ZWFtKG9iaikge1xuXHRcdHRoaXMuc3R1ZGVudFRlYW0gPSBvYmo7XG5cdH1cblx0Z2V0IHRlYW0oKSB7XG5cdFx0cmV0dXJuIHRoaXMuc3R1ZGVudFRlYW07XG5cdH1cblxuXHRzZXQgcHJlZmVycmVkTWVudG9yc0xpc3QoYXJyKSB7XG5cdFx0aWYgKCFBcnJheS5pc0FycmF5KGFycikpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcign0KHQv9C40YHQvtC6INC00L7Qu9C20LXQvSDQsdGL0YLRjCDQvNCw0YHRgdC40LLQvtC8LicpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGFyciA9IGFyci5tYXAoZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGxldCBtZW50b3IgPSBMaWIuc2VsZWN0KGl0ZW0pO1xuXHRcdFx0aWYgKCEobWVudG9yIGluc3RhbmNlb2YgTWVudG9yKSkgbWVudG9yID0gZmFsc2U7XG5cdFx0XHRyZXR1cm4gbWVudG9yO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zdHVkZW50UHJlZmVycmVkTWVudG9yc0xpc3QgPSBhcnIuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRpZiAoaXRlbSA9PT0gZmFsc2UpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0Z2V0IHByZWZlcnJlZE1lbnRvcnNMaXN0KCkge1xuXHRcdHJldHVybiB0aGlzLnN0dWRlbnRQcmVmZXJyZWRNZW50b3JzTGlzdDtcblx0fVxuXG5cdGFkZFByZWZlcnJlZE1lbnRvcihtZW50b3IsIHByaW9yaXR5KSB7XG5cdFx0aWYgKCh0eXBlb2YgcHJpb3JpdHkgPT09ICdudW1iZXInKSB8fCAhaXNOYU4obWVudG9yKSkge1xuXHRcdFx0cHJpb3JpdHkgPSBwYXJzZUludChwcmlvcml0eSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcign0J/RgNC40L7RgNC40YLQtdGCINC00L7Qu9C20LXQvSDQsdGL0YLRjCDRh9C40YHQu9C+0LwuJylcblx0XHR9XG5cblx0XHRpZiAoIShtZW50b3IgaW5zdGFuY2VvZiBNZW50b3IpKVxuXHRcdFx0bWVudG9yID0gTGliLnNlbGVjdChzZWxlY3Rvcik7XG5cdFx0aWYgKCEobWVudG9yIGluc3RhbmNlb2YgTWVudG9yKSlcblx0XHRcdHRocm93IG5ldyBFcnJvcign0JIg0YHQv9C40YHQvtC6INC80LXQvdGC0L7RgNC+0LIg0LzQvtC20L3QviDQtNC+0LHQsNCy0LvRj9GC0Ywg0YLQvtC70YzQutC+INC80LXQvdGC0L7RgNC+0LIuJyk7XG5cblx0XHRsZXQgbWVudG9yT2xkSW5kZXggPSB0aGlzLnN0dWRlbnRQcmVmZXJyZWRNZW50b3JzTGlzdC5pbmRleE9mKG1lbnRvcik7XG5cdFx0aWYgKG1lbnRvck9sZEluZGV4ICE9PSAtMSkge1xuXHRcdFx0dGhpcy5zdHVkZW50UHJlZmVycmVkTWVudG9yc0xpc3Quc3BsaWNlKG1lbnRvck9sZEluZGV4LCAxKTtcblx0XHR9XG5cdFx0dGhpcy5zdHVkZW50UHJlZmVycmVkTWVudG9yc0xpc3Quc3BsaWNlKHByaW9yaXR5LTEsIDAsIG1lbnRvcik7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRhZGRUYXNrcyh0YXNrcywgc3RvcCA9IGZhbHNlKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdHZhciB0YXNrSXNTZXQgPSBmYWxzZTtcblx0XHRpZiAodGFza3MgaW5zdGFuY2VvZiBUYXNrKSB7XG5cdFx0XHR0aGlzLnN0dWRlbnRUYXNrcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycikge1xuXHRcdFx0XHRpZiAodGFza3MgPT0gaXRlbS50YXNrKSB0YXNrSXNTZXQgPSB0cnVlO1xuXHRcdFx0fSk7XG5cdFx0XHRpZiAodGFza0lzU2V0KSByZXR1cm47XG5cdFx0XHRsZXQgdGFza1JlY29yZCA9IHtcblx0XHRcdFx0dGFzazogdGFza3MsXG5cdFx0XHRcdG1hcms6IDBcblx0XHRcdH1cblx0XHRcdHRoaXMuc3R1ZGVudFRhc2tzLnB1c2godGFza1JlY29yZCk7XHRcblx0XHRcdGlmIChzdG9wKSByZXR1cm47XG5cdFx0XHR0YXNrcy5hZGRFeGVjdXRvcnModGhpcywgdHJ1ZSk7XG5cdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHRhc2tzKSkge1xuXHRcdFx0dGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0XHRpdGVtID0gTGliLnNlbGVjdCgnaXRlbScpO1xuXG5cdFx0XHRcdHNlbGYuc3R1ZGVudFRhc2tzLmZvckVhY2goZnVuY3Rpb24oaW5uZXJJdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0XHRpZiAoaXRlbSA9PSBpbm5lckl0ZW0udGFzaykgdGFza0lzU2V0ID0gdHJ1ZTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0YXNrSXNTZXQpIHJldHVybjtcblxuXHRcdFx0XHRsZXQgdGFza1JlY29yZCA9IHtcblx0XHRcdFx0XHR0YXNrOiBpdGVtLFxuXHRcdFx0XHRcdG1hcms6IDBcblx0XHRcdFx0fVxuXHRcdFx0XHRzZWxmLnN0dWRlbnRUYXNrcy5wdXNoKHRhc2tSZWNvcmQpO1xuXHRcdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0XHRpdGVtLmFkZEV4ZWN1dG9ycyhzZWxmLCB0cnVlKTtcblx0XHRcdFx0XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRyZW1vdmVUYXNrcyhhcnIpIHtcblx0XHRsZXQgc2VsZiA9IHRoaXM7XG5cdFx0YXJyLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGxldCB0YXNrID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdGlmICghdGFzaykge1xuXHRcdFx0XHRjb25zb2xlLmxvZygn0JfQsNC00LDQvdC40LUgJysgaXRlbSArJyDQvdC1INC90LDQudC00LXQvdC+LicpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRsZXQgaW5kZXggPSBzZWxmLnN0dWRlbnRUYXNrcy5pbmRleE9mKHRhc2spO1xuXHRcdFx0aWYgKGluZGV4ICE9PSAtMSkge1xuXHRcdFx0XHRzZWxmLnN0dWRlbnRUYXNrcy5zcGxpY2UoaW5kZXgsMSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRzZXRNYXJrKHNlbGVjdG9yLCBtYXJrKSB7XG5cdFx0bGV0IHRhc2sgPSBMaWIuc2VsZWN0KHNlbGVjdG9yKTtcblx0XHRpZiAoIXRhc2sgfHwgISh0YXNrIGluc3RhbmNlb2YgVGFzaykpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcign0JfQsNC00LDQvdC40LUgJytzZWxlY3RvcisnINC90LUg0L3QsNC50LTQtdC90L4uJyk7XG5cdFx0fVxuXHRcdHRoaXMuc3R1ZGVudFRhc2tzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGlmIChpdGVtLnRhc2sgPT0gdGFzaykge1xuXHRcdFx0XHRpdGVtLm1hcmsgPSBtYXJrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxufVxuY2xhc3MgVGFzayBleHRlbmRzIExpYk9iamVjdCB7XG5cdGNvbnN0cnVjdG9yKG5ld0lkLCBuZXdUaXRsZSwgbmV3Q29udGVudCwgbmV3RXhlY3V0b3JzKSB7XG5cdFx0c3VwZXIoKTtcblx0XHR0aGlzLnRhc2tJZCA9IG5ld0lkO1xuXHRcdHRoaXMudGl0bGUgPSBuZXdUaXRsZTtcblx0XHR0aGlzLmNvbnRlbnQgPSBuZXdDb250ZW50O1xuXHRcdHRoaXMudGFza0V4ZWN1dG9ycyA9IChuZXdFeGVjdXRvcnMgIT09IHVuZGVmaW5lZClcblx0XHRcdD8gbmV3RXhlY3V0b3JzXG5cdFx0XHQ6IFtdO1xuXHR9XG5cblx0c2V0IGlkKG5ld0lkKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCfQndC10LvRjNC30Y8g0LzQtdC90Y/RgtGMIElELicpO1xuXHRcdHJldHVybjtcblx0fVxuXHRnZXQgaWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMudGFza0lkO1xuXHR9XG5cblx0c2V0IHRpdGxlKHN0cikge1xuXHRcdHRoaXMudGFza1RpdGxlID0gc3RyO1xuXHR9XG5cdGdldCB0aXRsZSgpe1xuXHRcdHJldHVybiB0aGlzLnRhc2tUaXRsZTtcblx0fVxuXG5cdHNldCBjb250ZW50KHN0cikge1xuXHRcdHRoaXMudGFza0NvbnRlbnQgPSBzdHI7XG5cdH1cblx0Z2V0IGNvbnRlbnQoKSB7XG5cdFx0cmV0dXJuIHRoaXMudGFza0NvbnRlbnQ7XG5cdH1cblxuXHQvLyBzZXQgZXhlY3V0b3JzKGFycikge1xuXHQvLyBcdHRoaXMudGFza0V4ZWN1dG9ycyA9IGFycjtcblx0Ly8gfVxuXHRnZXQgZXhlY3V0b3JzKCkge1xuXHRcdHJldHVybiB0aGlzLnRhc2tFeGVjdXRvcnM7XG5cdH1cblxuXHRhZGRFeGVjdXRvcnMoZXhlY3V0b3JzLCBzdG9wID0gZmFsc2UpIHtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0aWYgKChleGVjdXRvcnMgaW5zdGFuY2VvZiBTdHVkZW50KSB8fCAoaXRlbSBpbnN0YW5jZW9mIFRlYW0pKSB7XG5cdFx0XHRpZiAoZXhlY3V0b3JzIGluIHRoaXMudGFza0V4ZWN1dG9ycykgcmV0dXJuO1xuXHRcdFx0dGhpcy50YXNrRXhlY3V0b3JzLnB1c2goZXhlY3V0b3JzKTtcblx0XHRcdGlmIChzdG9wKSByZXR1cm47XG5cdFx0XHRleGVjdXRvcnMuYWRkVGFza3ModGhpcywgdHJ1ZSk7XG5cdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGV4ZWN1dG9ycykpIHtcblx0XHRcdGV4ZWN1dG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRcdGl0ZW0gPSBMaWIuc2VsZWN0KGl0ZW0pO1xuXHRcdFx0XHRpZiAoIShpdGVtIGluc3RhbmNlb2YgU3R1ZGVudCkgfHwgIShpdGVtIGluc3RhbmNlb2YgVGVhbSkpXG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQl9Cw0LTQsNC90LjQtSDQvNC+0LbQvdC+INC00LDRgtGMINGC0L7Qu9GM0LrQviDRgdGC0YPQtNC10L3RgtGDINC40LvQuCDQutC+0LzQsNC90LTQtScpO1xuXHRcdFx0XHRpZiAoaXRlbSBpbiBzZWxmLnRhc2tFeGVjdXRvcnMpIHJldHVybjtcblx0XHRcdFx0c2VsZi50YXNrRXhlY3V0b3JzLnB1c2goaXRlbSk7XG5cdFx0XHRcdGlmIChzdG9wKSByZXR1cm47XG5cdFx0XHRcdGl0ZW0uYWRkVGFza3Moc2VsZiwgdHJ1ZSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRyZW1vdmVFeGVjdXRvcnMoYXJyKSB7XG5cdFx0bGV0IHNlbGYgPSB0aGlzO1xuXHRcdGFyci5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgZXhlY3V0b3IgPSBMaWIuc2VsZWN0KGl0ZW0pO1xuXHRcdFx0aWYgKCFleGVjdXRvcikge1xuXHRcdFx0XHRjb25zb2xlLmxvZygn0KHRgtGD0LTQtdC90YIgJysgaXRlbSArJyDQvdC1INC90LDQudC00LXQvS4nKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0bGV0IGluZGV4ID0gc2VsZi50YXNrRXhlY3V0b3JzLmluZGV4T2YoZXhlY3V0b3IpO1xuXHRcdFx0aWYgKGluZGV4ICE9PSAtMSkge1xuXHRcdFx0XHRzZWxmLnRhc2tFeGVjdXRvcnMuc3BsaWNlKGluZGV4LDEpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cbn1cbmNsYXNzIFRlYW0gZXh0ZW5kcyBMaWJPYmplY3Qge1xuXHRjb25zdHJ1Y3RvcihuZXdJZCwgbmV3TmFtZSwgbmV3VGVhbW1hdGVzKSB7XG5cdFx0c3VwZXIoKTtcblx0XHR0aGlzLnRlYW1JZCA9IG5ld0lkO1xuXHRcdHRoaXMubmFtZSA9IG5ld05hbWU7XG5cdFx0dGhpcy50ZWFtVGFza3MgPSBbXTtcblx0XHR0aGlzLnRlYW1tYXRlcyA9IChuZXdUZWFtbWF0ZXMgIT09IHVuZGVmaW5lZCkgXG5cdFx0XHQ/IG5ld1RlYW1tYXRlc1xuXHRcdFx0OiBbXTtcblx0fVxuXG5cdHNldCBpZChuZXdJZCkge1xuXHRcdHRocm93IG5ldyBFcnJvcign0J3QtdC70YzQt9GPINC80LXQvdGP0YLRjCBJRC4nKTtcblx0XHRyZXR1cm47XG5cdH1cblx0Z2V0IGlkKCkge1xuXHRcdHJldHVybiB0aGlzLnRlYW1JZDtcblx0fVxuXG5cdHNldCBuYW1lKHN0cikge1xuXHRcdHRoaXMudGVhbU5hbWUgPSBzdHI7XG5cdH1cblx0Z2V0IG5hbWUoKXtcblx0XHRyZXR1cm4gdGhpcy50ZWFtTmFtZTtcblx0fVxuXG5cdHNldCB0ZWFtbWF0ZXMoYXJyKSB7XG5cdFx0dGhpcy50ZWFtVGVhbW1hdGVzID0gYXJyO1xuXHR9XG5cdGdldCB0ZWFtbWF0ZXMoKSB7XG5cdFx0cmV0dXJuIHRoaXMudGVhbVRlYW1tYXRlcztcblx0fVxuXG5cdGFkZFRlYW1tYXRlcyhzdHVkZW50cykge1xuXHRcdGlmIChzdHVkZW50cyBpbnN0YW5jZW9mIExpYk9iamVjdCkge1xuXHRcdFx0dGhpcy50ZWFtVGVhbW1hdGVzLnB1c2goc3R1ZGVudHMpO1x0XG5cdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHN0dWRlbnRzKSkge1xuXHRcdFx0c3R1ZGVudHMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0XHRpdGVtID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdFx0aWYgKCEoaXRlbSBpbnN0YW5jZW9mIFN0dWRlbnQpKVxuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcign0JIg0LrQvtC80LDQvdC00YMg0LzQvtC20L3QviDQtNC+0LHQsNCy0LjRgtGMINGC0L7Qu9GM0LrQviDRgdGC0YPQtNC10L3RgtC+0LInKTtcblx0XHRcdFx0dGhpcy50ZWFtVGVhbW1hdGVzLnB1c2goaXRlbSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRyZW1vdmVUZWFtbWF0ZXMoYXJyKSB7XG5cdFx0bGV0IHNlbGYgPSB0aGlzO1xuXHRcdGFyci5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgc3R1ZGVudCA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIXN0dWRlbnQpIGNvbnNvbGUubG9nKCfQodGC0YPQtNC10L3RgiAnKyBpdGVtICsnINC90LUg0L3QsNC50LTQtdC9LicpO1xuXHRcdFx0bGV0IGluZGV4ID0gc2VsZi50ZWFtVGVhbW1hdGVzLmluZGV4T2Yoc3R1ZGVudCk7XG5cdFx0XHRpZiAoaW5kZXggIT09IC0xKSB7XG5cdFx0XHRcdHNlbGYudGVhbVRlYW1tYXRlcy5zcGxpY2UoaW5kZXgsMSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRhZGRUYXNrcyh0YXNrcywgc3RvcCA9IGZhbHNlKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdHZhciB0YXNrSXNTZXQgPSBmYWxzZTtcblx0XHRpZiAodGFza3MgaW5zdGFuY2VvZiBUYXNrKSB7XG5cdFx0XHRzZWxmLnN0dWRlbnRUYXNrcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycikge1xuXHRcdFx0XHRpZiAodGFza3MgPT0gaXRlbS50YXNrKSB0YXNrSXNTZXQgPSB0cnVlO1xuXHRcdFx0fSk7XG5cdFx0XHRpZiAodGFza0lzU2V0KSByZXR1cm47XG5cdFx0XHRsZXQgdGFza1JlY29yZCA9IHtcblx0XHRcdFx0dGFzazogdGFza3MsXG5cdFx0XHRcdG1hcms6IDBcblx0XHRcdH1cblx0XHRcdHRoaXMudGVhbVRhc2tzLnB1c2godGFza1JlY29yZCk7XG5cdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0dGFza3MuYWRkRXhlY3V0b3JzKHRoaXMsIHRydWUpO1xuXHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh0YXNrcykpIHtcblx0XHRcdHRhc2tzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdFx0aXRlbSA9IExpYi5zZWxlY3QoJ2l0ZW0nKTtcblx0XHRcdFx0XG5cdFx0XHRcdHNlbGYudGVhbVRhc2tzLmZvckVhY2goZnVuY3Rpb24oaW5uZXJJdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0XHRpZiAoaXRlbSA9PSBpbm5lckl0ZW0udGFzaykgdGFza0lzU2V0ID0gdHJ1ZTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0YXNrSXNTZXQpIHJldHVybjtcblx0XHRcdFx0bGV0IHRhc2tSZWNvcmQgPSB7XG5cdFx0XHRcdFx0dGFzazogaXRlbSxcblx0XHRcdFx0XHRtYXJrOiAwXG5cdFx0XHRcdH1cblx0XHRcdFx0c2VsZi50ZWFtVGFza3MucHVzaCh0YXNrUmVjb3JkKTtcblx0XHRcdFx0aWYgKHN0b3ApIHJldHVybjtcblx0XHRcdFx0aXRlbS5hZGRFeGVjdXRvcnMoc2VsZiwgdHJ1ZSk7XG5cdFx0XHRcdFxuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0cmVtb3ZlVGFza3MoYXJyKSB7XG5cdFx0bGV0IHNlbGYgPSB0aGlzO1xuXHRcdGFyci5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgdGFzayA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIXRhc2spIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ9Ch0YLRg9C00LXQvdGCICcrIGl0ZW0gKycg0L3QtSDQvdCw0LnQtNC10L0uJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGxldCBpbmRleCA9IHNlbGYudGVhbVRhc2tzLmluZGV4T2YodGFzayk7XG5cdFx0XHRpZiAoaW5kZXggIT09IC0xKSB7XG5cdFx0XHRcdHNlbGYudGVhbVRhc2tzLnNwbGljZShpbmRleCwxKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdHNldE1hcmsoc2VsZWN0b3IsIG1hcmspIHtcblx0XHRsZXQgdGFzayA9IExpYi5zZWxlY3Qoc2VsZWN0b3IpO1xuXHRcdGlmICghKHRhc2sgaW5zdGFuY2VvZiBUYXNrKSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQl9Cw0LTQsNC90LjQtSAnK3NlbGVjdG9yKycg0L3QtSDQvdCw0LnQtNC10L3Qvi4nKTtcblx0XHR9XG5cdFx0dGhpcy50ZWFtVGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpIHtcblx0XHRcdGlmIChpdGVtLnRhc2sgPT0gdGFzaykge1xuXHRcdFx0XHRpdGVtLm1hcmsgPSBtYXJrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cbn1cbmNsYXNzIE1lbnRvciBleHRlbmRzIExpYk9iamVjdCB7XG5cdGNvbnN0cnVjdG9yKG5ld0lkLCBuZXdOYW1lLCBuZXdQcmVmZXJyZWRTdHVkZW50c0xpc3QpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMubWVudG9ySWQgPSBuZXdJZDtcblx0XHR0aGlzLm5hbWUgPSBuZXdOYW1lO1xuXHRcdHRoaXMucHJlZmVycmVkU3R1ZGVudHNMaXN0ID0gKG5ld1ByZWZlcnJlZFN0dWRlbnRzTGlzdCAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0PyBuZXdQcmVmZXJyZWRTdHVkZW50c0xpc3Rcblx0XHRcdDogW107XG5cdH1cblxuXHRzZXQgaWQobmV3SWQpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Cd0LXQu9GM0LfRjyDQvNC10L3Rj9GC0YwgSUQuJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGdldCBpZCgpIHtcblx0XHRyZXR1cm4gdGhpcy5tZW50b3JJZDtcblx0fVxuXG5cdHNldCBuYW1lKHN0cikge1xuXHRcdHRoaXMubWVudG9yTmFtZSA9IHN0cjtcblx0fVxuXHRnZXQgbmFtZSgpe1xuXHRcdHJldHVybiB0aGlzLm1lbnRvck5hbWU7XG5cdH1cblxuXHRzZXQgcHJlZmVycmVkU3R1ZGVudHNMaXN0KGFycikge1xuXHRcdGlmICh0eXBlb2YgYXJyICE9PSB0eXBlb2YgW10gKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Ch0L/QuNGB0L7QuiDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0LzQsNGB0YHQuNCy0L7QvC4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRhcnIgPSBhcnIubWFwKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgc3R1ZGVudCA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIShzdHVkZW50IGluc3RhbmNlb2YgU3R1ZGVudCkpIHN0dWRlbnQgPSBmYWxzZTtcblx0XHRcdHJldHVybiBzdHVkZW50O1xuXHRcdH0pO1xuXG5cdFx0Ly8gdGhpcy5tZW50b3JQcmVmZXJyZWRTdHVkZW50c0xpc3QgPSBhcnI7XG5cblx0XHR0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdCA9IGFyci5maWx0ZXIoZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGlmIChpdGVtID09PSBmYWxzZSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRnZXQgcHJlZmVycmVkU3R1ZGVudHNMaXN0KCkge1xuXHRcdHJldHVybiB0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdDtcblx0fVxuXG5cdGFkZFByZWZlcnJlZFN0dWRlbnQoc3R1ZGVudCwgcHJpb3JpdHkpIHtcblx0XHRpZiAoKHR5cGVvZiBwcmlvcml0eSA9PT0gJ251bWJlcicpIHx8ICFpc05hTihzdHVkZW50KSkge1xuXHRcdFx0cHJpb3JpdHkgPSBwYXJzZUludChwcmlvcml0eSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcign0J/RgNC40L7RgNC40YLQtdGCINC00L7Qu9C20LXQvSDQsdGL0YLRjCDRh9C40YHQu9C+0LwuJylcblx0XHR9XG5cblx0XHRpZiAoIShzdHVkZW50IGluc3RhbmNlb2YgU3R1ZGVudCkpXG5cdFx0XHRzdHVkZW50ID0gTGliLnNlbGVjdChzdHVkZW50KTtcblx0XHRpZiAoIShzdHVkZW50IGluc3RhbmNlb2YgU3R1ZGVudCkpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9CSINGB0L/QuNGB0L7QuiDRgdGC0YPQtNC10L3RgtC+0LIg0LzQvtC20L3QviDQtNC+0LHQsNCy0LvRj9GC0Ywg0YLQvtC70YzQutC+INGB0YLRg9C00LXQvdGC0L7Qsi4nKTtcblxuXHRcdGxldCBzdHVkZW50T2xkSW5kZXggPSB0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdC5pbmRleE9mKHN0dWRlbnQpO1xuXHRcdGlmIChzdHVkZW50T2xkSW5kZXggIT09IC0xKSB7XG5cdFx0XHR0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdC5zcGxpY2Uoc3R1ZGVudE9sZEluZGV4LCAxKTtcblx0XHR9XG5cdFx0dGhpcy5tZW50b3JQcmVmZXJyZWRTdHVkZW50c0xpc3Quc3BsaWNlKHByaW9yaXR5LTEsIDAsIHN0dWRlbnQpO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cdFxufVxuXG52YXIgdW5pcXVlSWQgPSAwO1xuXG52YXIgTGliID0ge1xuXG5cdGFkZDogZnVuY3Rpb24odHlwZSwgb3B0aW9ucywgLi4uYXJncyl7XG5cblx0XHQvLyDQntCx0YDQsNCx0L7RgtC60LAg0L7RiNC40LHQvtC6XG5cdFx0aWYgKCh0eXBlb2YgdHlwZSA9PT0gJ3VuZGVmaW5lZCcpIHx8ICh0eXBlLmxlbmd0aCA9PSAwKSlcblx0XHRcdHRocm93IG5ldyBFcnJvcign0KLQuNC/INC00L7Qu9C20LXQvSDQsdGL0YLRjCDRg9C60LDQt9Cw0L0uJylcblx0XHRlbHNlIGlmICh0eXBlb2YgdHlwZSAhPSAnc3RyaW5nJylcblx0XHRcdHRocm93IG5ldyBFcnJvcign0KLQuNC/INC00L7Qu9C20LXQvSDQsdGL0YLRjCDRgdGC0YDQvtC60L7QuScpO1xuXHRcdFxuXHRcdGlmICgodHlwZW9mIG9wdGlvbnMgPT09ICd1bmRlZmluZWQnKSB8fCAoISgnbmFtZScgaW4gb3B0aW9ucykgJiYgISgndGl0bGUnIGluIG9wdGlvbnMpKSlcblx0XHRcdHRocm93IG5ldyBFcnJvcign0J7RgtGB0YPRgtGB0YLQstGD0LXRgiBcXCdvcHRpb25zXFwnLiDQl9Cw0LTQsNC50YLQtSDQtdCz0L4g0YXQvtGC0Y8g0LHRiyDRgSDQvtC00L3QuNC8INGB0LLQvtC50YHRgtCy0L7QvCBcXCduYW1lXFwnINC40LvQuCBcXCd0aXRsZVxcJy4nKVxuXHRcdGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zICE9ICdvYmplY3QnKVxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdPcHRpb25zINC00L7Qu9C20LXQvSDQsdGL0YLRjCDQvtCx0YrQtdC60YLQvtC8IHt9LicpO1xuXG5cdFx0Ly8g0JTQvtCx0LDQstC70LXQvdC40LUg0L7QsdGK0LXQutGC0LBcblx0XHRzd2l0Y2ggKHR5cGUpIHtcblx0XHRcdFxuXHRcdFx0Y2FzZSAnc3R1ZGVudCc6XG5cdFx0XHRcdGxldCBzdHVkSWQgPSB1bmlxdWVJZCsrO1xuXHRcdFx0XHRsZXQgbmV3U3R1ZGVudCA9IG5ldyBTdHVkZW50KHN0dWRJZCwgb3B0aW9ucy5uYW1lLCBvcHRpb25zLnByZWZlcnJlZE1lbnRvcnNMaXN0KTtcblxuXHRcdFx0XHRpZiAob3B0aW9ucy50ZWFtKSB7XG5cdFx0XHRcdFx0bGV0IHRlYW1PYmogPSB0aGlzLnNlbGVjdChvcHRpb25zLnRlYW0pO1xuXHRcdFx0XHRcdGlmICghdGVhbU9iaikge1xuXHRcdFx0XHRcdFx0dGVhbU9iaiA9IExpYi5hZGQoJ3RlYW0nLCB7bmFtZTogb3B0aW9ucy50ZWFtfSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdG5ld1N0dWRlbnQudGVhbSA9IHRlYW1PYmo7XG5cdFx0XHRcdFx0dGVhbU9iai5hZGRUZWFtbWF0ZXMobmV3U3R1ZGVudCwgdHJ1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdExpYi5zdHVkZW50cy5wdXNoKG5ld1N0dWRlbnQpO1xuXHRcdFx0XHRjb25zb2xlLmxvZygnQWRkZWQgbmV3IFN0dWRlbnQ6ICcrIG5ld1N0dWRlbnQubmFtZSArJy4nKTtcblx0XHRcdFx0cmV0dXJuIG5ld1N0dWRlbnQ7XG5cdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAndGFzayc6XG5cdFx0XHRcdGxldCB0YXNrSWQgPSB1bmlxdWVJZCsrO1xuXHRcdFx0XHRsZXQgbmV3VGFzayA9IG5ldyBUYXNrKHRhc2tJZCwgb3B0aW9ucy50aXRsZSwgb3B0aW9ucy5jb250ZW50KTtcblxuXHRcdFx0XHRpZiAob3B0aW9ucy5leGVjdXRvcnMpIHtcblx0XHRcdFx0XHR2YXIgbmV3RXhlY3V0b3JzID0gb3B0aW9ucy5leGVjdXRvcnMubWFwKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRcdFx0XHRsZXQgcmVzID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdFx0XHRcdGlmICghcmVzKVxuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Cd0LXQstC+0LfQvNC+0LbQvdC+INC00L7QsdCw0LLQuNGC0Ywg0L3QtdGB0YPRidC10YHRgtCy0YPRjtGJ0LXQs9C+INC40YHQv9C+0LvQvdC40YLQtdC70Y8gJytpdGVtKycuJyk7XG5cdFx0XHRcdFx0XHRpZiAoIShyZXMgaW5zdGFuY2VvZiBTdHVkZW50KSAmJiAhKHJlcyBpbnN0YW5jZW9mIFRlYW0pKVxuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9CY0YHQv9C+0LvQvdC40YLQtdC70Ywg0LTQvtC70LbQtdC9INCx0YvRgtGMINGB0YLRg9C00LXQvdGC0L7QvCDQuNC70Lgg0LrQvtC80LDQvdC00L7QuS4nKTtcblx0XHRcdFx0XHRcdC8vIHJlcy5hZGRUYXNrcyhuZXdUYXNrKTtcblx0XHRcdFx0XHRcdHJldHVybiByZXM7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0bmV3VGFzay5hZGRFeGVjdXRvcnMobmV3RXhlY3V0b3JzKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0TGliLnRhc2tzLnB1c2gobmV3VGFzayk7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdBZGRlZCBuZXcgVGFzazogJysgbmV3VGFzay50aXRsZSArJy4nKTtcblx0XHRcdFx0cmV0dXJuIG5ld1Rhc2s7XG5cdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAndGVhbSc6XG5cdFx0XHRcdGxldCB0ZWFtSWQgPSB1bmlxdWVJZCsrO1xuXHRcdFx0XHRsZXQgbmV3VGVhbSA9IG5ldyBUZWFtKHRlYW1JZCwgb3B0aW9ucy5uYW1lKTtcblxuXHRcdFx0XHRpZiAob3B0aW9ucy50ZWFtbWF0ZXMpIHtcblx0XHRcdFx0XHR2YXIgbmV3VGVhbW1hdGVzID0gb3B0aW9ucy50ZWFtbWF0ZXMubWFwKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cblx0XHRcdFx0XHRcdGxldCBuZXdNYXRlID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdFx0XHRcdGlmICghbmV3TWF0ZSlcblx0XHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQndC10LLQvtC30LzQvtC20L3QviDQtNC+0LHQsNCy0LjRgtGMINCyINC60L7QvNCw0L3QtNGDINC90LXRgdGD0YnQtdGB0YLQstGD0Y7RidC10LPQviDRgdGC0YPQtNC10L3RgtCwICcraXRlbSsnLicpO1xuXHRcdFx0XHRcdFx0aWYgKCEobmV3TWF0ZSBpbnN0YW5jZW9mIFN0dWRlbnQpKVxuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9CSINC60L7QvNCw0L3QtNC1INC80L7Qs9GD0YIg0YHQvtGB0YLQvtGP0YLRjCDRgtC+0LvRjNC60L4g0YHRgtGD0LTQtdC90YLRiy4nKTtcblx0XHRcdFx0XHRcdC8vIG5ld01hdGUudGVhbSA9IG5ld1RlYW07XG5cdFx0XHRcdFx0XHRyZXR1cm4gbmV3TWF0ZTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdG5ld1RlYW0uYWRkVGVhbW1hdGVzKG5ld1RlYW1tYXRlcyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRMaWIudGVhbXMucHVzaChuZXdUZWFtKTtcblx0XHRcdFx0Y29uc29sZS5sb2coJ0FkZGVkIG5ldyBUZWFtOiAnKyBuZXdUZWFtLm5hbWUgKycuJyk7XG5cdFx0XHRcdHJldHVybiBuZXdUZWFtO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgJ21lbnRvcic6XG5cdFx0XHRcdGxldCBtZW50b3JJZCA9IHVuaXF1ZUlkKys7XG5cdFx0XHRcdGxldCBuZXdNZW50b3IgPSBuZXcgTWVudG9yKG1lbnRvcklkLCBvcHRpb25zLm5hbWUsIG9wdGlvbnMucHJlZmVycmVkU3R1ZGVudHNMaXN0KVxuXHRcdFx0XHRMaWIubWVudG9ycy5wdXNoKG5ld01lbnRvcik7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdBZGRlZCBuZXcgTWVudG9yOiAnKyBuZXdNZW50b3IubmFtZSArJy4nKTtcblx0XHRcdFx0cmV0dXJuIG5ld01lbnRvcjtcblx0XHRcdGJyZWFrO1xuXG5cdFx0XHQvLyDQldGB0LvQuCDRgtC40L8g0LfQsNC00LDQvSDQvdC10LLQtdGA0L3QvlxuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQotC40L/QsCBcXCcnKyB0eXBlICsnXFwnINC90LUg0YHRg9GJ0LXRgdGC0LLRg9C10YIuJyk7XG5cdFx0XHRicmVhaztcblx0XHR9XG5cdH0sXG5cdFxuXG5cdGVkaXQ6IGZ1bmN0aW9uKHNlbGVjdG9yLCBvcHRpb25zKSB7XG5cblx0XHQvLyDQntCx0YDQsNCx0L7RgtC60LAg0L7RiNC40LHQvtC6XG5cdFx0aWYgKCh0eXBlb2Ygc2VsZWN0b3IgPT09ICd1bmRlZmluZWQnKSB8fCAoc2VsZWN0b3IubGVuZ3RoID09IDApKVxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQodC10LvQtdC60YLQvtGAINC00L7Qu9C20LXQvSDQsdGL0YLRjCDRg9C60LDQt9Cw0L0uJylcblx0XHRlbHNlIGlmICgodHlwZW9mIHNlbGVjdG9yICE9ICdzdHJpbmcnKSAmJiAodHlwZW9mIHNlbGVjdG9yICE9ICdudW1iZXInKSlcblx0XHRcdHRocm93IG5ldyBFcnJvcign0KHQtdC70LXQutGC0L7RgCDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0YHRgtGA0L7QutC+0Lkg0LjQu9C4INGH0LjRgdC70L7QvCcpO1xuXHRcdFxuXHRcdGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ3VuZGVmaW5lZCcpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Ce0YLRgdGD0YLRgdGC0LLRg9C10YIgXFwnb3B0aW9uc1xcJy4g0JfQsNC00LDQudGC0LUg0LXQs9C+INGF0L7RgtGPINCx0Ysg0YEg0L7QtNC90LjQvCDRgdCy0L7QudGB0YLQstC+0LwuJylcblx0XHRlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucyAhPSAnb2JqZWN0Jylcblx0XHRcdHRocm93IG5ldyBFcnJvcignT3B0aW9ucyDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0L7QsdGK0LXQutGC0L7QvCB7fS4nKTtcblxuXHRcdC8vINCf0YDQsNCy0LrQsCDQvtCx0YrQtdC60YLQsFxuXHRcdHZhciBvYmplY3QgPSB0aGlzLnNlbGVjdChzZWxlY3Rvcik7XG5cdFx0Zm9yIChsZXQgcHJvcCBpbiBvcHRpb25zKSB7XG5cdFx0XHRpZiAocHJvcCA9PSAnaWQnKSBjb250aW51ZTtcblx0XHRcdG9iamVjdFtwcm9wXSA9IG9wdGlvbnNbcHJvcF07XG5cdFx0fVxuXHRcdHJldHVybiBvYmplY3Q7XG5cdH0sXG5cblxuXHRzdHVkZW50czogW10sXG5cdG1lbnRvcnM6IFtdLFxuXHR0YXNrczogW10sXG5cdHRlYW1zOiBbXSxcblxuXG5cdHNlbGVjdDogZnVuY3Rpb24oc2VsZWN0b3IpIHtcblx0XHR2YXIgcmVzdWx0ID0gdW5kZWZpbmVkO1xuXHRcdGlmICgodHlwZW9mIHNlbGVjdG9yID09PSAnbnVtYmVyJykgfHwgIWlzTmFOKHNlbGVjdG9yKSkge1xuXHRcdFx0dmFyIHNlbGVjdG9yID0gcGFyc2VJbnQoc2VsZWN0b3IpO1xuXG5cdFx0XHRMaWIuc3R1ZGVudHMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0aWYgKChpdGVtLmlkID09IHNlbGVjdG9yKSAmJiAhcmVzdWx0KSB7XG5cdFx0XHRcdFx0cmVzdWx0ID0gaXRlbTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRpZiAocmVzdWx0KSByZXR1cm4gcmVzdWx0O1xuXG5cdFx0XHRcblx0XHRcdExpYi5tZW50b3JzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKSB7XG5cdFx0XHRcdGlmICgoaXRlbS5pZCA9PSBzZWxlY3RvcikgJiYgIXJlc3VsdCkge1xuXHRcdFx0XHRcdHJlc3VsdCA9IGl0ZW07XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aWYgKHJlc3VsdCkgcmV0dXJuIHJlc3VsdDtcblx0XHRcdFxuXHRcdFx0XG5cdFx0XHRMaWIudGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0aWYgKChpdGVtLmlkID09IHNlbGVjdG9yKSAmJiAhcmVzdWx0KSB7XG5cdFx0XHRcdFx0cmVzdWx0ID0gaXRlbTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRpZiAocmVzdWx0KSByZXR1cm4gcmVzdWx0O1xuXHRcdFx0XG5cdFx0XHRcblx0XHRcdExpYi50ZWFtcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycikge1xuXHRcdFx0XHRpZiAoKGl0ZW0uaWQgPT0gc2VsZWN0b3IpICYmICFyZXN1bHQpIHtcblx0XHRcdFx0XHRyZXN1bHQgPSBpdGVtO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdGlmIChyZXN1bHQpIHJldHVybiByZXN1bHQ7XG5cdFx0XHRcblxuXHRcdH0gZWxzZSBpZiAodHlwZW9mIHNlbGVjdG9yID09ICdzdHJpbmcnKSB7XG5cblx0XHRcdExpYi5zdHVkZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycikge1xuXHRcdFx0XHRpZiAoKGl0ZW0ubmFtZSA9PSBzZWxlY3RvcikgJiYgIXJlc3VsdCkge1xuXHRcdFx0XHRcdHJlc3VsdCA9IGl0ZW07XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aWYgKHJlc3VsdCkgcmV0dXJuIHJlc3VsdDtcblxuXHRcdFx0XG5cdFx0XHRMaWIubWVudG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycikge1xuXHRcdFx0XHRpZiAoKGl0ZW0ubmFtZSA9PSBzZWxlY3RvcikgJiYgIXJlc3VsdCkge1xuXHRcdFx0XHRcdHJlc3VsdCA9IGl0ZW07XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aWYgKHJlc3VsdCkgcmV0dXJuIHJlc3VsdDtcblx0XHRcdFxuXHRcdFx0XG5cdFx0XHRMaWIudGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0aWYgKChpdGVtLnRpdGxlID09IHNlbGVjdG9yKSAmJiAhcmVzdWx0KSB7XG5cdFx0XHRcdFx0cmVzdWx0ID0gaXRlbTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRpZiAocmVzdWx0KSByZXR1cm4gcmVzdWx0O1xuXHRcdFx0XG5cdFx0XHRcblx0XHRcdExpYi50ZWFtcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycikge1xuXHRcdFx0XHRpZiAoKGl0ZW0ubmFtZSA9PSBzZWxlY3RvcikgJiYgIXJlc3VsdCkge1xuXHRcdFx0XHRcdHJlc3VsdCA9IGl0ZW07XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0aWYgKHJlc3VsdCkgcmV0dXJuIHJlc3VsdDtcblxuXHRcdH0gZWxzZSBpZiAoc2VsZWN0b3IgaW5zdGFuY2VvZiBMaWJPYmplY3QpIHtcblx0XHRcdHJldHVybiBzZWxlY3Rvcjtcblx0XHR9XG5cblx0XHRpZiAocmVzdWx0ID09IHVuZGVmaW5lZCkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0Ly8gdGhyb3cgbmV3IEVycm9yKCfQntCx0YrQtdC60YIgJytzZWxlY3RvcisnINC90LUg0L3QsNC50LTQtdC9Jyk7XG5cdFx0fVxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sXG5cblx0Z2V0RmluYWxQcmlvcml0eUxpc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBmaW5hbEFyciA9IFtdO1xuXHRcdHRoaXMubWVudG9ycy5mb3JFYWNoKGZ1bmN0aW9uKG1lbnRvciwgaSwgYXJyKXtcblx0XHRcdGxldCBtZW50b3JTdHVkZW50c0xpc3QgPSBtZW50b3IucHJlZmVycmVkU3R1ZGVudHNMaXN0O1xuXHRcdFx0bGV0IGluZGV4ZXMgPSBbXTtcblx0XHRcdGxldCBiZXN0U3R1ZGVudDtcblxuXHRcdFx0bWVudG9yU3R1ZGVudHNMaXN0LmZvckVhY2goZnVuY3Rpb24ocHJlZlN0dWRlbnQsIHN0dWRlbnRJbmRleCwgYXJyKXtcblx0XHRcdFx0bGV0IHByZWZNZW50b3JzTGlzdCA9IHByZWZTdHVkZW50LnByZWZlcnJlZE1lbnRvcnNMaXN0O1xuXHRcdFx0XHRsZXQgbWVudG9ySW5kZXggPSBwcmVmTWVudG9yc0xpc3QuaW5kZXhPZihtZW50b3IpO1xuXHRcdFx0XHRsZXQgaXNTdHVkZW50QWRkZWQgPSBmYWxzZTtcblxuXHRcdFx0XHRmaW5hbEFyci5mb3JFYWNoKCBmdW5jdGlvbihpdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0XHRpZiAoaXRlbS5zdHVkZW50ID09IHByZWZTdHVkZW50KSBpc1N0dWRlbnRBZGRlZCA9IHRydWU7XG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0XHRpZiAoKG1lbnRvckluZGV4ID09IC0xKSB8fCAoaXNTdHVkZW50QWRkZWQpKSByZXR1cm47XG5cblx0XHRcdFx0aW5kZXhlcy5wdXNoKHtcblx0XHRcdFx0XHRpbmRleDogbWVudG9ySW5kZXggKyBzdHVkZW50SW5kZXgsXG5cdFx0XHRcdFx0c3R1ZGVudDogcHJlZlN0dWRlbnRcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0aW5kZXhlcy5mb3JFYWNoKGZ1bmN0aW9uKGN1cnJlbnRTdHVkZW50LCBpLCBhcnIpe1xuXHRcdFx0XHRpZiAoaSA9PSAwKSB7XG5cdFx0XHRcdFx0YmVzdFN0dWRlbnQgPSBjdXJyZW50U3R1ZGVudDtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoY3VycmVudFN0dWRlbnQuaW5kZXggPCBiZXN0U3R1ZGVudC5pbmRleCkge1xuXHRcdFx0XHRcdGJlc3RTdHVkZW50ID0gY3VycmVudFN0dWRlbnQ7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRmaW5hbEFyci5wdXNoKHtcblx0XHRcdFx0bWVudG9yOiBtZW50b3IsXG5cdFx0XHRcdHN0dWRlbnQ6IGJlc3RTdHVkZW50LnN0dWRlbnQsXG5cdFx0XHRcdGluZGV4OiBiZXN0U3R1ZGVudC5pbmRleFxuXHRcdFx0fSk7XG5cblx0XHR9KTtcblxuXG5cdFx0cmV0dXJuIGZpbmFsQXJyO1xuXHR9XG59O1xuXG53aW5kb3cuTGliID0gTGliO1xufSkoKTtcblxuLy8gVGVzdFxuTGliLmFkZCgnc3R1ZGVudCcsIHtuYW1lOiAnVG9seWEnLCB0ZWFtOiAnVGVhbURpbm8nfSk7ICBcdFx0XHRcdFx0XHRcdFx0IC8vIGlkID0gMFxuTGliLmFkZCgnc3R1ZGVudCcsIHtuYW1lOiAnTWFzaGEnLCB0ZWFtOiAnVGVhbURpbm8nfSk7ICBcdFx0XHRcdFx0XHRcdFx0IC8vIGlkID0gMlxuTGliLmFkZCgnc3R1ZGVudCcsIHtuYW1lOiAnQW5kcmV3JywgdGVhbTogJ1RlYW1EaW5vJ30pOyBcdFx0XHRcdFx0XHRcdFx0IC8vIGlkID0gM1xuTGliLmFkZCgnc3R1ZGVudCcsIHtuYW1lOiAnUGV0eWEnLCB0ZWFtOiAnVGVhbURpbm8nfSk7ICBcdFx0XHRcdFx0XHRcdFx0IC8vIGlkID0gNFxuXG5MaWIuYWRkKCdtZW50b3InLCB7bmFtZTogJ0dvbG9kbm92JywgcHJlZmVycmVkU3R1ZGVudHNMaXN0OiBbMCwyLDMsNF19KTsgLy8gaWQgPSA1XG5MaWIuYWRkKCdtZW50b3InLCB7bmFtZTogJ0JlbGF5YScsIHByZWZlcnJlZFN0dWRlbnRzTGlzdDogWzMsNCwwLDJdfSk7ICAgLy8gaWQgPSA2XG5MaWIuYWRkKCdtZW50b3InLCB7bmFtZTogJ0NoZXNub2tvdicsIHByZWZlcnJlZFN0dWRlbnRzTGlzdDogWzQsMywyXX0pOyAgLy8gaWQgPSA3XG5cbkxpYi5zZWxlY3QoMCkucHJlZmVycmVkTWVudG9yc0xpc3QgPSBbNSw2LDddO1xuTGliLnNlbGVjdCgyKS5wcmVmZXJyZWRNZW50b3JzTGlzdCA9IFs1LDYsN107XG5MaWIuc2VsZWN0KDMpLnByZWZlcnJlZE1lbnRvcnNMaXN0ID0gWzcsNiw1XTtcbkxpYi5zZWxlY3QoNCkucHJlZmVycmVkTWVudG9yc0xpc3QgPSBbNiw1XTtcblxuY29uc29sZS50aW1lKCdhJyk7XG52YXIgbGlzdCA9IExpYi5nZXRGaW5hbFByaW9yaXR5TGlzdCgpO1xuY29uc29sZS50aW1lRW5kKCdhJyk7XG4iLCJjbGFzcyBTdHVkZW50IGV4dGVuZHMgTGliT2JqZWN0IHtcblx0Y29uc3RydWN0b3IobmV3SWQsIG5ld05hbWUsIG5ld01lbnRvcnMsIG5ld1RlYW0pIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMuc3R1ZGVudElkID0gbmV3SWQ7XG5cdFx0dGhpcy5zdHVkZW50VGFza3MgPSBbXTtcblx0XHR0aGlzLm5hbWUgPSBuZXdOYW1lO1xuXHRcdC8vIGlmIChuZXdUZWFtICE9PSB1bmRlZmluZWQpIHRoaXMudGVhbSA9IG5ld1RlYW07XG5cdFx0dGhpcy5wcmVmZXJyZWRNZW50b3JzTGlzdCA9IChuZXdNZW50b3JzICE9PSB1bmRlZmluZWQpXG5cdFx0XHQ/IG5ld01lbnRvcnNcblx0XHRcdDogW107XG5cdH1cblxuXG5cdHNldCBpZChuZXdJZCkge1xuXHRcdHRocm93IG5ldyBFcnJvcign0J3QtdC70YzQt9GPINC80LXQvdGP0YLRjCBJRC4nKTtcblx0XHRyZXR1cm47XG5cdH1cblx0Z2V0IGlkKCkge1xuXHRcdHJldHVybiB0aGlzLnN0dWRlbnRJZDtcblx0fVxuXG5cdHNldCBuYW1lKHN0cikge1xuXHRcdHRoaXMuc3R1ZGVudE5hbWUgPSBzdHI7XG5cdH1cblx0Z2V0IG5hbWUoKXtcblx0XHRyZXR1cm4gdGhpcy5zdHVkZW50TmFtZTtcblx0fVxuXG5cdHNldCB0ZWFtKG9iaikge1xuXHRcdHRoaXMuc3R1ZGVudFRlYW0gPSBvYmo7XG5cdH1cblx0Z2V0IHRlYW0oKSB7XG5cdFx0cmV0dXJuIHRoaXMuc3R1ZGVudFRlYW07XG5cdH1cblxuXHRzZXQgcHJlZmVycmVkTWVudG9yc0xpc3QoYXJyKSB7XG5cdFx0aWYgKCFBcnJheS5pc0FycmF5KGFycikpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcign0KHQv9C40YHQvtC6INC00L7Qu9C20LXQvSDQsdGL0YLRjCDQvNCw0YHRgdC40LLQvtC8LicpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGFyciA9IGFyci5tYXAoZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGxldCBtZW50b3IgPSBMaWIuc2VsZWN0KGl0ZW0pO1xuXHRcdFx0aWYgKCEobWVudG9yIGluc3RhbmNlb2YgTWVudG9yKSkgbWVudG9yID0gZmFsc2U7XG5cdFx0XHRyZXR1cm4gbWVudG9yO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5zdHVkZW50UHJlZmVycmVkTWVudG9yc0xpc3QgPSBhcnIuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRpZiAoaXRlbSA9PT0gZmFsc2UpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0Z2V0IHByZWZlcnJlZE1lbnRvcnNMaXN0KCkge1xuXHRcdHJldHVybiB0aGlzLnN0dWRlbnRQcmVmZXJyZWRNZW50b3JzTGlzdDtcblx0fVxuXG5cdGFkZFByZWZlcnJlZE1lbnRvcihtZW50b3IsIHByaW9yaXR5KSB7XG5cdFx0aWYgKCh0eXBlb2YgcHJpb3JpdHkgPT09ICdudW1iZXInKSB8fCAhaXNOYU4obWVudG9yKSkge1xuXHRcdFx0cHJpb3JpdHkgPSBwYXJzZUludChwcmlvcml0eSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcign0J/RgNC40L7RgNC40YLQtdGCINC00L7Qu9C20LXQvSDQsdGL0YLRjCDRh9C40YHQu9C+0LwuJylcblx0XHR9XG5cblx0XHRpZiAoIShtZW50b3IgaW5zdGFuY2VvZiBNZW50b3IpKVxuXHRcdFx0bWVudG9yID0gTGliLnNlbGVjdChzZWxlY3Rvcik7XG5cdFx0aWYgKCEobWVudG9yIGluc3RhbmNlb2YgTWVudG9yKSlcblx0XHRcdHRocm93IG5ldyBFcnJvcign0JIg0YHQv9C40YHQvtC6INC80LXQvdGC0L7RgNC+0LIg0LzQvtC20L3QviDQtNC+0LHQsNCy0LvRj9GC0Ywg0YLQvtC70YzQutC+INC80LXQvdGC0L7RgNC+0LIuJyk7XG5cblx0XHRsZXQgbWVudG9yT2xkSW5kZXggPSB0aGlzLnN0dWRlbnRQcmVmZXJyZWRNZW50b3JzTGlzdC5pbmRleE9mKG1lbnRvcik7XG5cdFx0aWYgKG1lbnRvck9sZEluZGV4ICE9PSAtMSkge1xuXHRcdFx0dGhpcy5zdHVkZW50UHJlZmVycmVkTWVudG9yc0xpc3Quc3BsaWNlKG1lbnRvck9sZEluZGV4LCAxKTtcblx0XHR9XG5cdFx0dGhpcy5zdHVkZW50UHJlZmVycmVkTWVudG9yc0xpc3Quc3BsaWNlKHByaW9yaXR5LTEsIDAsIG1lbnRvcik7XG5cdFx0XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRhZGRUYXNrcyh0YXNrcywgc3RvcCA9IGZhbHNlKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdHZhciB0YXNrSXNTZXQgPSBmYWxzZTtcblx0XHRpZiAodGFza3MgaW5zdGFuY2VvZiBUYXNrKSB7XG5cdFx0XHR0aGlzLnN0dWRlbnRUYXNrcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycikge1xuXHRcdFx0XHRpZiAodGFza3MgPT0gaXRlbS50YXNrKSB0YXNrSXNTZXQgPSB0cnVlO1xuXHRcdFx0fSk7XG5cdFx0XHRpZiAodGFza0lzU2V0KSByZXR1cm47XG5cdFx0XHRsZXQgdGFza1JlY29yZCA9IHtcblx0XHRcdFx0dGFzazogdGFza3MsXG5cdFx0XHRcdG1hcms6IDBcblx0XHRcdH1cblx0XHRcdHRoaXMuc3R1ZGVudFRhc2tzLnB1c2godGFza1JlY29yZCk7XHRcblx0XHRcdGlmIChzdG9wKSByZXR1cm47XG5cdFx0XHR0YXNrcy5hZGRFeGVjdXRvcnModGhpcywgdHJ1ZSk7XG5cdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHRhc2tzKSkge1xuXHRcdFx0dGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0XHRpdGVtID0gTGliLnNlbGVjdCgnaXRlbScpO1xuXG5cdFx0XHRcdHNlbGYuc3R1ZGVudFRhc2tzLmZvckVhY2goZnVuY3Rpb24oaW5uZXJJdGVtLCBpLCBhcnIpIHtcblx0XHRcdFx0XHRpZiAoaXRlbSA9PSBpbm5lckl0ZW0udGFzaykgdGFza0lzU2V0ID0gdHJ1ZTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmICh0YXNrSXNTZXQpIHJldHVybjtcblxuXHRcdFx0XHRsZXQgdGFza1JlY29yZCA9IHtcblx0XHRcdFx0XHR0YXNrOiBpdGVtLFxuXHRcdFx0XHRcdG1hcms6IDBcblx0XHRcdFx0fVxuXHRcdFx0XHRzZWxmLnN0dWRlbnRUYXNrcy5wdXNoKHRhc2tSZWNvcmQpO1xuXHRcdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0XHRpdGVtLmFkZEV4ZWN1dG9ycyhzZWxmLCB0cnVlKTtcblx0XHRcdFx0XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRyZW1vdmVUYXNrcyhhcnIpIHtcblx0XHRsZXQgc2VsZiA9IHRoaXM7XG5cdFx0YXJyLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGxldCB0YXNrID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdGlmICghdGFzaykge1xuXHRcdFx0XHRjb25zb2xlLmxvZygn0JfQsNC00LDQvdC40LUgJysgaXRlbSArJyDQvdC1INC90LDQudC00LXQvdC+LicpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRsZXQgaW5kZXggPSBzZWxmLnN0dWRlbnRUYXNrcy5pbmRleE9mKHRhc2spO1xuXHRcdFx0aWYgKGluZGV4ICE9PSAtMSkge1xuXHRcdFx0XHRzZWxmLnN0dWRlbnRUYXNrcy5zcGxpY2UoaW5kZXgsMSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRzZXRNYXJrKHNlbGVjdG9yLCBtYXJrKSB7XG5cdFx0bGV0IHRhc2sgPSBMaWIuc2VsZWN0KHNlbGVjdG9yKTtcblx0XHRpZiAoIXRhc2sgfHwgISh0YXNrIGluc3RhbmNlb2YgVGFzaykpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcign0JfQsNC00LDQvdC40LUgJytzZWxlY3RvcisnINC90LUg0L3QsNC50LTQtdC90L4uJyk7XG5cdFx0fVxuXHRcdHRoaXMuc3R1ZGVudFRhc2tzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGlmIChpdGVtLnRhc2sgPT0gdGFzaykge1xuXHRcdFx0XHRpdGVtLm1hcmsgPSBtYXJrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxufSIsImNsYXNzIFRhc2sgZXh0ZW5kcyBMaWJPYmplY3Qge1xuXHRjb25zdHJ1Y3RvcihuZXdJZCwgbmV3VGl0bGUsIG5ld0NvbnRlbnQsIG5ld0V4ZWN1dG9ycykge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy50YXNrSWQgPSBuZXdJZDtcblx0XHR0aGlzLnRpdGxlID0gbmV3VGl0bGU7XG5cdFx0dGhpcy5jb250ZW50ID0gbmV3Q29udGVudDtcblx0XHR0aGlzLnRhc2tFeGVjdXRvcnMgPSAobmV3RXhlY3V0b3JzICE9PSB1bmRlZmluZWQpXG5cdFx0XHQ/IG5ld0V4ZWN1dG9yc1xuXHRcdFx0OiBbXTtcblx0fVxuXG5cdHNldCBpZChuZXdJZCkge1xuXHRcdHRocm93IG5ldyBFcnJvcign0J3QtdC70YzQt9GPINC80LXQvdGP0YLRjCBJRC4nKTtcblx0XHRyZXR1cm47XG5cdH1cblx0Z2V0IGlkKCkge1xuXHRcdHJldHVybiB0aGlzLnRhc2tJZDtcblx0fVxuXG5cdHNldCB0aXRsZShzdHIpIHtcblx0XHR0aGlzLnRhc2tUaXRsZSA9IHN0cjtcblx0fVxuXHRnZXQgdGl0bGUoKXtcblx0XHRyZXR1cm4gdGhpcy50YXNrVGl0bGU7XG5cdH1cblxuXHRzZXQgY29udGVudChzdHIpIHtcblx0XHR0aGlzLnRhc2tDb250ZW50ID0gc3RyO1xuXHR9XG5cdGdldCBjb250ZW50KCkge1xuXHRcdHJldHVybiB0aGlzLnRhc2tDb250ZW50O1xuXHR9XG5cblx0Ly8gc2V0IGV4ZWN1dG9ycyhhcnIpIHtcblx0Ly8gXHR0aGlzLnRhc2tFeGVjdXRvcnMgPSBhcnI7XG5cdC8vIH1cblx0Z2V0IGV4ZWN1dG9ycygpIHtcblx0XHRyZXR1cm4gdGhpcy50YXNrRXhlY3V0b3JzO1xuXHR9XG5cblx0YWRkRXhlY3V0b3JzKGV4ZWN1dG9ycywgc3RvcCA9IGZhbHNlKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdGlmICgoZXhlY3V0b3JzIGluc3RhbmNlb2YgU3R1ZGVudCkgfHwgKGl0ZW0gaW5zdGFuY2VvZiBUZWFtKSkge1xuXHRcdFx0aWYgKGV4ZWN1dG9ycyBpbiB0aGlzLnRhc2tFeGVjdXRvcnMpIHJldHVybjtcblx0XHRcdHRoaXMudGFza0V4ZWN1dG9ycy5wdXNoKGV4ZWN1dG9ycyk7XG5cdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0ZXhlY3V0b3JzLmFkZFRhc2tzKHRoaXMsIHRydWUpO1xuXHRcdH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShleGVjdXRvcnMpKSB7XG5cdFx0XHRleGVjdXRvcnMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0XHRpdGVtID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdFx0aWYgKCEoaXRlbSBpbnN0YW5jZW9mIFN0dWRlbnQpIHx8ICEoaXRlbSBpbnN0YW5jZW9mIFRlYW0pKVxuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcign0JfQsNC00LDQvdC40LUg0LzQvtC20L3QviDQtNCw0YLRjCDRgtC+0LvRjNC60L4g0YHRgtGD0LTQtdC90YLRgyDQuNC70Lgg0LrQvtC80LDQvdC00LUnKTtcblx0XHRcdFx0aWYgKGl0ZW0gaW4gc2VsZi50YXNrRXhlY3V0b3JzKSByZXR1cm47XG5cdFx0XHRcdHNlbGYudGFza0V4ZWN1dG9ycy5wdXNoKGl0ZW0pO1xuXHRcdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0XHRpdGVtLmFkZFRhc2tzKHNlbGYsIHRydWUpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0cmVtb3ZlRXhlY3V0b3JzKGFycikge1xuXHRcdGxldCBzZWxmID0gdGhpcztcblx0XHRhcnIuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0bGV0IGV4ZWN1dG9yID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdGlmICghZXhlY3V0b3IpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ9Ch0YLRg9C00LXQvdGCICcrIGl0ZW0gKycg0L3QtSDQvdCw0LnQtNC10L0uJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGxldCBpbmRleCA9IHNlbGYudGFza0V4ZWN1dG9ycy5pbmRleE9mKGV4ZWN1dG9yKTtcblx0XHRcdGlmIChpbmRleCAhPT0gLTEpIHtcblx0XHRcdFx0c2VsZi50YXNrRXhlY3V0b3JzLnNwbGljZShpbmRleCwxKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG59IiwiY2xhc3MgVGVhbSBleHRlbmRzIExpYk9iamVjdCB7XG5cdGNvbnN0cnVjdG9yKG5ld0lkLCBuZXdOYW1lLCBuZXdUZWFtbWF0ZXMpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMudGVhbUlkID0gbmV3SWQ7XG5cdFx0dGhpcy5uYW1lID0gbmV3TmFtZTtcblx0XHR0aGlzLnRlYW1UYXNrcyA9IFtdO1xuXHRcdHRoaXMudGVhbW1hdGVzID0gKG5ld1RlYW1tYXRlcyAhPT0gdW5kZWZpbmVkKSBcblx0XHRcdD8gbmV3VGVhbW1hdGVzXG5cdFx0XHQ6IFtdO1xuXHR9XG5cblx0c2V0IGlkKG5ld0lkKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCfQndC10LvRjNC30Y8g0LzQtdC90Y/RgtGMIElELicpO1xuXHRcdHJldHVybjtcblx0fVxuXHRnZXQgaWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMudGVhbUlkO1xuXHR9XG5cblx0c2V0IG5hbWUoc3RyKSB7XG5cdFx0dGhpcy50ZWFtTmFtZSA9IHN0cjtcblx0fVxuXHRnZXQgbmFtZSgpe1xuXHRcdHJldHVybiB0aGlzLnRlYW1OYW1lO1xuXHR9XG5cblx0c2V0IHRlYW1tYXRlcyhhcnIpIHtcblx0XHR0aGlzLnRlYW1UZWFtbWF0ZXMgPSBhcnI7XG5cdH1cblx0Z2V0IHRlYW1tYXRlcygpIHtcblx0XHRyZXR1cm4gdGhpcy50ZWFtVGVhbW1hdGVzO1xuXHR9XG5cblx0YWRkVGVhbW1hdGVzKHN0dWRlbnRzKSB7XG5cdFx0aWYgKHN0dWRlbnRzIGluc3RhbmNlb2YgTGliT2JqZWN0KSB7XG5cdFx0XHR0aGlzLnRlYW1UZWFtbWF0ZXMucHVzaChzdHVkZW50cyk7XHRcblx0XHR9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoc3R1ZGVudHMpKSB7XG5cdFx0XHRzdHVkZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRcdGl0ZW0gPSBMaWIuc2VsZWN0KGl0ZW0pO1xuXHRcdFx0XHRpZiAoIShpdGVtIGluc3RhbmNlb2YgU3R1ZGVudCkpXG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCfQkiDQutC+0LzQsNC90LTRgyDQvNC+0LbQvdC+INC00L7QsdCw0LLQuNGC0Ywg0YLQvtC70YzQutC+INGB0YLRg9C00LXQvdGC0L7QsicpO1xuXHRcdFx0XHR0aGlzLnRlYW1UZWFtbWF0ZXMucHVzaChpdGVtKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdHJlbW92ZVRlYW1tYXRlcyhhcnIpIHtcblx0XHRsZXQgc2VsZiA9IHRoaXM7XG5cdFx0YXJyLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGxldCBzdHVkZW50ID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdGlmICghc3R1ZGVudCkgY29uc29sZS5sb2coJ9Ch0YLRg9C00LXQvdGCICcrIGl0ZW0gKycg0L3QtSDQvdCw0LnQtNC10L0uJyk7XG5cdFx0XHRsZXQgaW5kZXggPSBzZWxmLnRlYW1UZWFtbWF0ZXMuaW5kZXhPZihzdHVkZW50KTtcblx0XHRcdGlmIChpbmRleCAhPT0gLTEpIHtcblx0XHRcdFx0c2VsZi50ZWFtVGVhbW1hdGVzLnNwbGljZShpbmRleCwxKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdGFkZFRhc2tzKHRhc2tzLCBzdG9wID0gZmFsc2UpIHtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0dmFyIHRhc2tJc1NldCA9IGZhbHNlO1xuXHRcdGlmICh0YXNrcyBpbnN0YW5jZW9mIFRhc2spIHtcblx0XHRcdHNlbGYuc3R1ZGVudFRhc2tzLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKSB7XG5cdFx0XHRcdGlmICh0YXNrcyA9PSBpdGVtLnRhc2spIHRhc2tJc1NldCA9IHRydWU7XG5cdFx0XHR9KTtcblx0XHRcdGlmICh0YXNrSXNTZXQpIHJldHVybjtcblx0XHRcdGxldCB0YXNrUmVjb3JkID0ge1xuXHRcdFx0XHR0YXNrOiB0YXNrcyxcblx0XHRcdFx0bWFyazogMFxuXHRcdFx0fVxuXHRcdFx0dGhpcy50ZWFtVGFza3MucHVzaCh0YXNrUmVjb3JkKTtcblx0XHRcdGlmIChzdG9wKSByZXR1cm47XG5cdFx0XHR0YXNrcy5hZGRFeGVjdXRvcnModGhpcywgdHJ1ZSk7XG5cdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHRhc2tzKSkge1xuXHRcdFx0dGFza3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpLCBhcnIpe1xuXHRcdFx0XHRpdGVtID0gTGliLnNlbGVjdCgnaXRlbScpO1xuXHRcdFx0XHRcblx0XHRcdFx0c2VsZi50ZWFtVGFza3MuZm9yRWFjaChmdW5jdGlvbihpbm5lckl0ZW0sIGksIGFycikge1xuXHRcdFx0XHRcdGlmIChpdGVtID09IGlubmVySXRlbS50YXNrKSB0YXNrSXNTZXQgPSB0cnVlO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHRhc2tJc1NldCkgcmV0dXJuO1xuXHRcdFx0XHRsZXQgdGFza1JlY29yZCA9IHtcblx0XHRcdFx0XHR0YXNrOiBpdGVtLFxuXHRcdFx0XHRcdG1hcms6IDBcblx0XHRcdFx0fVxuXHRcdFx0XHRzZWxmLnRlYW1UYXNrcy5wdXNoKHRhc2tSZWNvcmQpO1xuXHRcdFx0XHRpZiAoc3RvcCkgcmV0dXJuO1xuXHRcdFx0XHRpdGVtLmFkZEV4ZWN1dG9ycyhzZWxmLCB0cnVlKTtcblx0XHRcdFx0XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRyZW1vdmVUYXNrcyhhcnIpIHtcblx0XHRsZXQgc2VsZiA9IHRoaXM7XG5cdFx0YXJyLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGxldCB0YXNrID0gTGliLnNlbGVjdChpdGVtKTtcblx0XHRcdGlmICghdGFzaykge1xuXHRcdFx0XHRjb25zb2xlLmxvZygn0KHRgtGD0LTQtdC90YIgJysgaXRlbSArJyDQvdC1INC90LDQudC00LXQvS4nKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0bGV0IGluZGV4ID0gc2VsZi50ZWFtVGFza3MuaW5kZXhPZih0YXNrKTtcblx0XHRcdGlmIChpbmRleCAhPT0gLTEpIHtcblx0XHRcdFx0c2VsZi50ZWFtVGFza3Muc3BsaWNlKGluZGV4LDEpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0c2V0TWFyayhzZWxlY3RvciwgbWFyaykge1xuXHRcdGxldCB0YXNrID0gTGliLnNlbGVjdChzZWxlY3Rvcik7XG5cdFx0aWYgKCEodGFzayBpbnN0YW5jZW9mIFRhc2spKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9CX0LDQtNCw0L3QuNC1ICcrc2VsZWN0b3IrJyDQvdC1INC90LDQudC00LXQvdC+LicpO1xuXHRcdH1cblx0XHR0aGlzLnRlYW1UYXNrcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGksIGFycikge1xuXHRcdFx0aWYgKGl0ZW0udGFzayA9PSB0YXNrKSB7XG5cdFx0XHRcdGl0ZW0ubWFyayA9IG1hcms7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxufSIsImNsYXNzIE1lbnRvciBleHRlbmRzIExpYk9iamVjdCB7XG5cdGNvbnN0cnVjdG9yKG5ld0lkLCBuZXdOYW1lLCBuZXdQcmVmZXJyZWRTdHVkZW50c0xpc3QpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMubWVudG9ySWQgPSBuZXdJZDtcblx0XHR0aGlzLm5hbWUgPSBuZXdOYW1lO1xuXHRcdHRoaXMucHJlZmVycmVkU3R1ZGVudHNMaXN0ID0gKG5ld1ByZWZlcnJlZFN0dWRlbnRzTGlzdCAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0PyBuZXdQcmVmZXJyZWRTdHVkZW50c0xpc3Rcblx0XHRcdDogW107XG5cdH1cblxuXHRzZXQgaWQobmV3SWQpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Cd0LXQu9GM0LfRjyDQvNC10L3Rj9GC0YwgSUQuJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGdldCBpZCgpIHtcblx0XHRyZXR1cm4gdGhpcy5tZW50b3JJZDtcblx0fVxuXG5cdHNldCBuYW1lKHN0cikge1xuXHRcdHRoaXMubWVudG9yTmFtZSA9IHN0cjtcblx0fVxuXHRnZXQgbmFtZSgpe1xuXHRcdHJldHVybiB0aGlzLm1lbnRvck5hbWU7XG5cdH1cblxuXHRzZXQgcHJlZmVycmVkU3R1ZGVudHNMaXN0KGFycikge1xuXHRcdGlmICh0eXBlb2YgYXJyICE9PSB0eXBlb2YgW10gKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9Ch0L/QuNGB0L7QuiDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0LzQsNGB0YHQuNCy0L7QvC4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRhcnIgPSBhcnIubWFwKGZ1bmN0aW9uKGl0ZW0sIGksIGFycil7XG5cdFx0XHRsZXQgc3R1ZGVudCA9IExpYi5zZWxlY3QoaXRlbSk7XG5cdFx0XHRpZiAoIShzdHVkZW50IGluc3RhbmNlb2YgU3R1ZGVudCkpIHN0dWRlbnQgPSBmYWxzZTtcblx0XHRcdHJldHVybiBzdHVkZW50O1xuXHRcdH0pO1xuXG5cdFx0Ly8gdGhpcy5tZW50b3JQcmVmZXJyZWRTdHVkZW50c0xpc3QgPSBhcnI7XG5cblx0XHR0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdCA9IGFyci5maWx0ZXIoZnVuY3Rpb24oaXRlbSwgaSwgYXJyKXtcblx0XHRcdGlmIChpdGVtID09PSBmYWxzZSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHRnZXQgcHJlZmVycmVkU3R1ZGVudHNMaXN0KCkge1xuXHRcdHJldHVybiB0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdDtcblx0fVxuXG5cdGFkZFByZWZlcnJlZFN0dWRlbnQoc3R1ZGVudCwgcHJpb3JpdHkpIHtcblx0XHRpZiAoKHR5cGVvZiBwcmlvcml0eSA9PT0gJ251bWJlcicpIHx8ICFpc05hTihzdHVkZW50KSkge1xuXHRcdFx0cHJpb3JpdHkgPSBwYXJzZUludChwcmlvcml0eSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcign0J/RgNC40L7RgNC40YLQtdGCINC00L7Qu9C20LXQvSDQsdGL0YLRjCDRh9C40YHQu9C+0LwuJylcblx0XHR9XG5cblx0XHRpZiAoIShzdHVkZW50IGluc3RhbmNlb2YgU3R1ZGVudCkpXG5cdFx0XHRzdHVkZW50ID0gTGliLnNlbGVjdChzdHVkZW50KTtcblx0XHRpZiAoIShzdHVkZW50IGluc3RhbmNlb2YgU3R1ZGVudCkpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ9CSINGB0L/QuNGB0L7QuiDRgdGC0YPQtNC10L3RgtC+0LIg0LzQvtC20L3QviDQtNC+0LHQsNCy0LvRj9GC0Ywg0YLQvtC70YzQutC+INGB0YLRg9C00LXQvdGC0L7Qsi4nKTtcblxuXHRcdGxldCBzdHVkZW50T2xkSW5kZXggPSB0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdC5pbmRleE9mKHN0dWRlbnQpO1xuXHRcdGlmIChzdHVkZW50T2xkSW5kZXggIT09IC0xKSB7XG5cdFx0XHR0aGlzLm1lbnRvclByZWZlcnJlZFN0dWRlbnRzTGlzdC5zcGxpY2Uoc3R1ZGVudE9sZEluZGV4LCAxKTtcblx0XHR9XG5cdFx0dGhpcy5tZW50b3JQcmVmZXJyZWRTdHVkZW50c0xpc3Quc3BsaWNlKHByaW9yaXR5LTEsIDAsIHN0dWRlbnQpO1xuXHRcdFxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cdFxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
